<!DOCTYPE html> 
<html lang="he" dir="rtl" data-whatinput="keyboard" data-whatintent="mouse"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>מערכת ניהול אירועי בר מצווה</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Netlify Identity -->
    <script type="text/javascript" src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    <!-- Auth0 -->
    <script src="https://cdn.auth0.com/js/auth0-spa-js/2.0/auth0-spa-js.production.js"></script>
    <!-- Decap CMS -->
    <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script><style>:root{--toastify-color-light:#fff;--toastify-color-dark:#121212;--toastify-color-info:#3498db;--toastify-color-success:#07bc0c;--toastify-color-warning:#f1c40f;--toastify-color-error:#e74c3c;--toastify-color-transparent:hsla(0,0%,100%,.7);--toastify-icon-color-info:var(--toastify-color-info);--toastify-icon-color-success:var(--toastify-color-success);--toastify-icon-color-warning:var(--toastify-color-warning);--toastify-icon-color-error:var(--toastify-color-error);--toastify-toast-width:320px;--toastify-toast-background:#fff;--toastify-toast-min-height:64px;--toastify-toast-max-height:800px;--toastify-font-family:sans-serif;--toastify-z-index:9999;--toastify-text-color-light:#757575;--toastify-text-color-dark:#fff;--toastify-text-color-info:#fff;--toastify-text-color-success:#fff;--toastify-text-color-warning:#fff;--toastify-text-color-error:#fff;--toastify-spinner-color:#616161;--toastify-spinner-color-empty-area:#e0e0e0;--toastify-color-progress-light:linear-gradient(90deg,#4cd964,#5ac8fa,#007aff,#34aadc,#5856d6,#ff2d55);--toastify-color-progress-dark:#bb86fc;--toastify-color-progress-info:var(--toastify-color-info);--toastify-color-progress-success:var(--toastify-color-success);--toastify-color-progress-warning:var(--toastify-color-warning);--toastify-color-progress-error:var(--toastify-color-error)}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translateZ(var(--toastify-z-index));position:fixed;padding:4px;width:var(--toastify-toast-width);box-sizing:border-box;color:#fff}.Toastify__toast-container--top-left{top:1em;left:1em}.Toastify__toast-container--top-center{top:1em;left:50%;transform:translateX(-50%)}.Toastify__toast-container--top-right{top:1em;right:1em}.Toastify__toast-container--bottom-left{bottom:1em;left:1em}.Toastify__toast-container--bottom-center{bottom:1em;left:50%;transform:translateX(-50%)}.Toastify__toast-container--bottom-right{bottom:1em;right:1em}@media only screen and (max-width:480px){.Toastify__toast-container{width:100vw;padding:0;left:0;margin:0}.Toastify__toast-container--top-center,.Toastify__toast-container--top-left,.Toastify__toast-container--top-right{top:0;transform:translateX(0)}.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-right{bottom:0;transform:translateX(0)}.Toastify__toast-container--rtl{right:0;left:auto}}.Toastify__toast{position:relative;min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:8px;border-radius:4px;box-shadow:0 1px 10px 0 rgba(0,0,0,.1),0 2px 15px 0 rgba(0,0,0,.05);display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;max-height:var(--toastify-toast-max-height);overflow:hidden;font-family:var(--toastify-font-family);cursor:default;direction:ltr;z-index:0}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-body{margin:auto 0;-ms-flex:1 1 auto;flex:1 1 auto;padding:6px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.Toastify__toast-body>div:last-child{word-break:break-word;-ms-flex:1;flex:1}.Toastify__toast-icon{-webkit-margin-end:10px;margin-inline-end:10px;width:20px;-ms-flex-negative:0;flex-shrink:0;display:-ms-flexbox;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.7s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}@media only screen and (max-width:480px){.Toastify__toast{margin-bottom:0;border-radius:0}}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--colored.Toastify__toast--default,.Toastify__toast-theme--light{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;-ms-flex-item-align:start;align-self:flex-start}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:focus,.Toastify__close-button:hover{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:5px;z-index:var(--toastify-z-index);opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:auto;transform-origin:right}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,0,0)}to{opacity:0;transform:translate3d(2000px,0,0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,0,0)}to{opacity:0;transform:translate3d(-2000px,0,0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,-10px,0)}40%,45%{opacity:1;transform:translate3d(0,20px,0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,10px,0)}40%,45%{opacity:1;transform:translate3d(0,-20px,0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--bottom-left,.Toastify__bounce-enter--top-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--bottom-right,.Toastify__bounce-enter--top-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--bottom-left,.Toastify__bounce-exit--top-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--bottom-right,.Toastify__bounce-exit--top-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:perspective(400px)}30%{transform:perspective(400px) rotateX(-20deg);opacity:1}to{transform:perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translateZ(0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translateZ(0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translateZ(0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translateZ(0)}}@keyframes Toastify__slideOutRight{0%{transform:translateZ(0)}to{visibility:hidden;transform:translate3d(110%,0,0)}}@keyframes Toastify__slideOutLeft{0%{transform:translateZ(0)}to{visibility:hidden;transform:translate3d(-110%,0,0)}}@keyframes Toastify__slideOutDown{0%{transform:translateZ(0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translateZ(0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--bottom-left,.Toastify__slide-enter--top-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--bottom-right,.Toastify__slide-enter--top-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--bottom-left,.Toastify__slide-exit--top-left{animation-name:Toastify__slideOutLeft}.Toastify__slide-exit--bottom-right,.Toastify__slide-exit--top-right{animation-name:Toastify__slideOutRight}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown}@keyframes Toastify__spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}</style><style type="text/css">
.uploadcare-tab-effects--crops{display:-ms-flexbox;display:flex;-ms-flex-pack:distribute;justify-content:space-around;max-width:100%}
.uploadcare-tab-effects--effect-button{-ms-flex-negative:1;flex-shrink:1;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:end;justify-content:flex-end;-ms-flex-align:center;align-items:center;padding:0;width:45px;height:45px;border-color:transparent;background:transparent;color:#212121;fill:#212121}.uploadcare-tab-effects--effect-button:active,.uploadcare-tab-effects--effect-button:focus,.uploadcare-tab-effects--effect-button:hover{fill:#0969ee;color:#0969ee}.uploadcare-tab-effects--effect-button:focus,.uploadcare-tab-effects--effect-button:hover{border-color:transparent;background:transparent}.uploadcare-tab-effects--effect-button[aria-disabled=true]{border-color:transparent!important;background:transparent!important;color:#d4d2d2!important;fill:#d4d2d2!important}.uploadcare-tab-effects--effect-button:before{content:"";display:block;-ms-flex-order:1;order:1;margin:1px 0;width:6px;height:6px;background:transparent;border-radius:50%}.uploadcare-tab-effects--effect-button_applied:before{background:#157cfc}@media (min-width:760px){.uploadcare-tab-effects--effect-button:focus,.uploadcare-tab-effects--effect-button:hover{position:relative;overflow:visible}.uploadcare-tab-effects--effect-button:focus:after,.uploadcare-tab-effects--effect-button:hover:after{content:attr(aria-label);display:block;position:absolute;top:0;left:50%;width:auto;height:auto;background:#e3e1e1;color:#212121;transform:translateX(-50%) translateY(-100%);padding:12px;border-radius:6px;line-height:1;min-width:100%}}
.uploadcare-tab-effects--icon{height:32px}
.uploadcare-tab-effects--effects{display:-ms-flexbox;display:flex;-ms-flex-pack:distribute;justify-content:space-around;max-width:100%}
.uploadcare-tab-effects--additions{-ms-flex-positive:1;flex-grow:1}


.uploadcare-tab-effects--range{-ms-flex-positive:1;flex-grow:1}input[type=range].uploadcare-tab-effects--range__input{box-sizing:border-box;margin:0;padding:0;width:100%;height:40px;line-height:1}input[type=range].uploadcare-tab-effects--range__input:focus{outline:2px solid rgba(21,124,252,.5);outline-offset:1px}input[type=range].uploadcare-tab-effects--range__input::-moz-range-track{background:#d4d2d2}input[type=range].uploadcare-tab-effects--range__input::-moz-range-progress{background:#157cfc}input[type=range].uploadcare-tab-effects--range__input::-moz-range-thumb{border:none;background:#212121;box-shadow:none}input[type=range].uploadcare-tab-effects--range__input::-moz-range-thumb:focus,input[type=range].uploadcare-tab-effects--range__input::-moz-range-thumb:hover{background:#000}input[type=range].uploadcare-tab-effects--range__input::-moz-range-thumb:active{background:#000}input[type=range].uploadcare-tab-effects--range__input::-ms-track{background:#d4d2d2}input[type=range].uploadcare-tab-effects--range__input::-ms-fill-lower{background:#157cfc}input[type=range].uploadcare-tab-effects--range__input::-ms-thumb{background:#212121}input[type=range].uploadcare-tab-effects--range__input::-ms-thumb:active,input[type=range].uploadcare-tab-effects--range__input:focus::-ms-thumb{background:#000}</style>
    
    <!-- PWA Manifest -->
    <link rel="manifest" id="manifest" href="data:application/json,%7B%22name%22%3A%22%D7%9E%D7%A2%D7%A8%D7%9B%D7%AA%20%D7%A0%D7%99%D7%94%D7%95%D7%9C%20%D7%90%D7%99%D7%A8%D7%95%D7%A2%D7%99%20%D7%91%D7%A8%20%D7%9E%D7%A6%D7%95%D7%95%D7%94%22%2C%22short_name%22%3A%22%D7%91%D7%A8%20%D7%9E%D7%A6%D7%95%D7%95%D7%94%20%D7%9E%D7%A0%D7%94%D7%9C%22%2C%22description%22%3A%22%D7%9E%D7%A2%D7%A8%D7%9B%D7%AA%20%D7%A0%D7%99%D7%94%D7%95%D7%9C%20%D7%9E%D7%A7%D7%A6%D7%95%D7%A2%D7%99%D7%AA%20%D7%9C%D7%90%D7%99%D7%A8%D7%95%D7%A2%D7%99%20%D7%91%D7%A8%20%D7%9E%D7%A6%D7%95%D7%95%D7%94%22%2C%22start_url%22%3A%22%2F%22%2C%22display%22%3A%22standalone%22%2C%22background_color%22%3A%22%23ffffff%22%2C%22theme_color%22%3A%22%231e3a8a%22%2C%22icons%22%3A%5B%7B%22src%22%3A%22data%3Aimage%2Fsvg%2Bxml%2C%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%20192%20192'%3E%3Crect%20width%3D'192'%20height%3D'192'%20fill%3D'%25231e3a8a'%2F%3E%3Ctext%20y%3D'96'%20x%3D'96'%20text-anchor%3D'middle'%20dominant-baseline%3D'middle'%20font-size%3D'80'%20fill%3D'white'%3E%F0%9F%8E%B5%3C%2Ftext%3E%3C%2Fsvg%3E%22%2C%22sizes%22%3A%22192x192%22%2C%22type%22%3A%22image%2Fsvg%2Bxml%22%7D%2C%7B%22src%22%3A%22data%3Aimage%2Fsvg%2Bxml%2C%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%20512%20512'%3E%3Crect%20width%3D'512'%20height%3D'512'%20fill%3D'%25231e3a8a'%2F%3E%3Ctext%20y%3D'256'%20x%3D'256'%20text-anchor%3D'middle'%20dominant-baseline%3D'middle'%20font-size%3D'200'%20fill%3D'white'%3E%F0%9F%8E%B5%3C%2Ftext%3E%3C%2Fsvg%3E%22%2C%22sizes%22%3A%22512x512%22%2C%22type%22%3A%22image%2Fsvg%2Bxml%22%7D%5D%7D">
    <meta name="theme-color" content="#1e3a8a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="בר מצווה מנהל">
    <link rel="apple-touch-icon" href="data:image/svg+xml,&lt;svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'&gt;&lt;rect width='100' height='100' fill='%231e3a8a'/&gt;&lt;text y='50' x='50' text-anchor='middle' dominant-baseline='middle' font-size='40' fill='white'&gt;🎵&lt;/text&gt;&lt;/svg&gt;">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1e3a8a',
                        secondary: '#374151',
                        accent: '#059669'
                    },
                    fontFamily: {
                        'rounded': ['ui-rounded', 'system-ui', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Varela+Round&family=Nunito:wght@300;400;500;600;700;800&display=swap');
        body { 
            font-family: 'Nunito', 'Varela Round', sans-serif; 
            font-weight: 500;
        }
        .gradient-header { background: linear-gradient(135deg, #1e3a8a 0%, #3730a3 100%); }
        .card-professional { 
            transition: all 0.3s ease; 
            border-left: 4px solid transparent;
        }
        .card-professional:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.15);
            border-left-color: #1e3a8a;
        }
        .card-gradient-1 { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .card-gradient-2 { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
        .card-gradient-3 { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
        .card-gradient-4 { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }
        .card-gradient-5 { background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); }
        .card-gradient-6 { background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); }
        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
        }
        .sidebar {
            transform: translateX(100%);
            transition: transform 0.3s ease-in-out;
        }
        .sidebar.open {
            transform: translateX(0);
        }
        .song-card {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-left: 4px solid #3b82f6;
        }
        .song-card:nth-child(even) {
            background: linear-gradient(135deg, #fef7ff 0%, #f3e8ff 100%);
            border-left-color: #8b5cf6;
        }
        .song-card:nth-child(3n) {
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            border-left-color: #10b981;
        }
    </style>
<style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.16 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.container{width:100%}@media (min-width: 640px){.container{max-width:640px}}@media (min-width: 768px){.container{max-width:768px}}@media (min-width: 1024px){.container{max-width:1024px}}@media (min-width: 1280px){.container{max-width:1280px}}@media (min-width: 1536px){.container{max-width:1536px}}.fixed{position:fixed}.sticky{position:sticky}.inset-0{inset:0px}.right-0{right:0px}.top-0{top:0px}.right-4{right:1rem}.top-4{top:1rem}.z-40{z-index:40}.z-50{z-index:50}.mx-auto{margin-left:auto;margin-right:auto}.mb-1{margin-bottom:0.25rem}.mb-2{margin-bottom:0.5rem}.mb-3{margin-bottom:0.75rem}.mb-4{margin-bottom:1rem}.ml-2{margin-left:0.5rem}.ml-3{margin-left:0.75rem}.mt-4{margin-top:1rem}.mr-2{margin-right:0.5rem}.mt-6{margin-top:1.5rem}.inline-block{display:inline-block}.flex{display:flex}.grid{display:grid}.hidden{display:none}.h-full{height:100%}.max-h-\[95vh\]{max-height:95vh}.min-h-screen{min-height:100vh}.w-80{width:20rem}.w-full{width:100%}.max-w-4xl{max-width:56rem}.flex-1{flex:1 1 0%}.cursor-pointer{cursor:pointer}.grid-cols-1{grid-template-columns:repeat(1, minmax(0, 1fr))}.flex-col{flex-direction:column}.items-start{align-items:flex-start}.items-center{align-items:center}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-3{gap:0.75rem}.gap-4{gap:1rem}.space-x-3 > :not([hidden]) ~ :not([hidden]){--tw-space-x-reverse:0;margin-right:calc(0.75rem * var(--tw-space-x-reverse));margin-left:calc(0.75rem * calc(1 - var(--tw-space-x-reverse)))}.space-y-2 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.5rem * var(--tw-space-y-reverse))}.space-y-4 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}.space-y-3 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.75rem * var(--tw-space-y-reverse))}.space-x-reverse > :not([hidden]) ~ :not([hidden]){--tw-space-x-reverse:1}.divide-y > :not([hidden]) ~ :not([hidden]){--tw-divide-y-reverse:0;border-top-width:calc(1px * calc(1 - var(--tw-divide-y-reverse)));border-bottom-width:calc(1px * var(--tw-divide-y-reverse))}.divide-gray-200 > :not([hidden]) ~ :not([hidden]){--tw-divide-opacity:1;border-color:rgb(229 231 235 / var(--tw-divide-opacity, 1))}.self-start{align-self:flex-start}.overflow-hidden{overflow:hidden}.overflow-y-auto{overflow-y:auto}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.rounded-2xl{border-radius:1rem}.rounded-3xl{border-radius:1.5rem}.rounded-full{border-radius:9999px}.rounded-xl{border-radius:0.75rem}.rounded-t-3xl{border-top-left-radius:1.5rem;border-top-right-radius:1.5rem}.border{border-width:1px}.border-b{border-bottom-width:1px}.border-t{border-top-width:1px}.border-gray-100{--tw-border-opacity:1;border-color:rgb(243 244 246 / var(--tw-border-opacity, 1))}.border-gray-200{--tw-border-opacity:1;border-color:rgb(229 231 235 / var(--tw-border-opacity, 1))}.border-gray-300{--tw-border-opacity:1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1))}.border-green-200{--tw-border-opacity:1;border-color:rgb(187 247 208 / var(--tw-border-opacity, 1))}.border-blue-200{--tw-border-opacity:1;border-color:rgb(191 219 254 / var(--tw-border-opacity, 1))}.border-orange-200{--tw-border-opacity:1;border-color:rgb(254 215 170 / var(--tw-border-opacity, 1))}.border-purple-200{--tw-border-opacity:1;border-color:rgb(233 213 255 / var(--tw-border-opacity, 1))}.border-amber-200{--tw-border-opacity:1;border-color:rgb(253 230 138 / var(--tw-border-opacity, 1))}.border-blue-100{--tw-border-opacity:1;border-color:rgb(219 234 254 / var(--tw-border-opacity, 1))}.bg-black{--tw-bg-opacity:1;background-color:rgb(0 0 0 / var(--tw-bg-opacity, 1))}.bg-blue-600{--tw-bg-opacity:1;background-color:rgb(37 99 235 / var(--tw-bg-opacity, 1))}.bg-gray-50{--tw-bg-opacity:1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.bg-green-50{--tw-bg-opacity:1;background-color:rgb(240 253 244 / var(--tw-bg-opacity, 1))}.bg-green-600{--tw-bg-opacity:1;background-color:rgb(22 163 74 / var(--tw-bg-opacity, 1))}.bg-purple-600{--tw-bg-opacity:1;background-color:rgb(147 51 234 / var(--tw-bg-opacity, 1))}.bg-red-600{--tw-bg-opacity:1;background-color:rgb(220 38 38 / var(--tw-bg-opacity, 1))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-blue-50{--tw-bg-opacity:1;background-color:rgb(239 246 255 / var(--tw-bg-opacity, 1))}.bg-green-500{--tw-bg-opacity:1;background-color:rgb(34 197 94 / var(--tw-bg-opacity, 1))}.bg-orange-50{--tw-bg-opacity:1;background-color:rgb(255 247 237 / var(--tw-bg-opacity, 1))}.bg-purple-50{--tw-bg-opacity:1;background-color:rgb(250 245 255 / var(--tw-bg-opacity, 1))}.bg-amber-50{--tw-bg-opacity:1;background-color:rgb(255 251 235 / var(--tw-bg-opacity, 1))}.bg-blue-100{--tw-bg-opacity:1;background-color:rgb(219 234 254 / var(--tw-bg-opacity, 1))}.bg-gray-200{--tw-bg-opacity:1;background-color:rgb(229 231 235 / var(--tw-bg-opacity, 1))}.bg-green-100{--tw-bg-opacity:1;background-color:rgb(220 252 231 / var(--tw-bg-opacity, 1))}.bg-orange-100{--tw-bg-opacity:1;background-color:rgb(255 237 213 / var(--tw-bg-opacity, 1))}.bg-purple-100{--tw-bg-opacity:1;background-color:rgb(243 232 255 / var(--tw-bg-opacity, 1))}.bg-opacity-20{--tw-bg-opacity:0.2}.bg-opacity-50{--tw-bg-opacity:0.5}.bg-opacity-80{--tw-bg-opacity:0.8}.bg-gradient-to-l{background-image:linear-gradient(to left, var(--tw-gradient-stops))}.from-blue-50{--tw-gradient-from:#eff6ff var(--tw-gradient-from-position);--tw-gradient-to:rgb(239 246 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from), var(--tw-gradient-to)}.from-blue-600{--tw-gradient-from:#2563eb var(--tw-gradient-from-position);--tw-gradient-to:rgb(37 99 235 / 0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from), var(--tw-gradient-to)}.from-emerald-50{--tw-gradient-from:#ecfdf5 var(--tw-gradient-from-position);--tw-gradient-to:rgb(236 253 245 / 0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from), var(--tw-gradient-to)}.from-green-50{--tw-gradient-from:#f0fdf4 var(--tw-gradient-from-position);--tw-gradient-to:rgb(240 253 244 / 0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from), var(--tw-gradient-to)}.from-orange-50{--tw-gradient-from:#fff7ed var(--tw-gradient-from-position);--tw-gradient-to:rgb(255 247 237 / 0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-50{--tw-gradient-from:#faf5ff var(--tw-gradient-from-position);--tw-gradient-to:rgb(250 245 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from), var(--tw-gradient-to)}.from-red-50{--tw-gradient-from:#fef2f2 var(--tw-gradient-from-position);--tw-gradient-to:rgb(254 242 242 / 0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from), var(--tw-gradient-to)}.to-emerald-50{--tw-gradient-to:#ecfdf5 var(--tw-gradient-to-position)}.to-indigo-50{--tw-gradient-to:#eef2ff var(--tw-gradient-to-position)}.to-pink-50{--tw-gradient-to:#fdf2f8 var(--tw-gradient-to-position)}.to-purple-600{--tw-gradient-to:#9333ea var(--tw-gradient-to-position)}.to-red-50{--tw-gradient-to:#fef2f2 var(--tw-gradient-to-position)}.to-teal-50{--tw-gradient-to:#f0fdfa var(--tw-gradient-to-position)}.p-1{padding:0.25rem}.p-2{padding:0.5rem}.p-3{padding:0.75rem}.p-4{padding:1rem}.p-6{padding:1.5rem}.px-3{padding-left:0.75rem;padding-right:0.75rem}.px-4{padding-left:1rem;padding-right:1rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.py-4{padding-top:1rem;padding-bottom:1rem}.py-6{padding-top:1.5rem;padding-bottom:1.5rem}.py-1{padding-top:0.25rem;padding-bottom:0.25rem}.pt-4{padding-top:1rem}.text-right{text-align:right}.text-2xl{font-size:1.5rem;line-height:2rem}.text-base{font-size:1rem;line-height:1.5rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-xs{font-size:0.75rem;line-height:1rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-semibold{font-weight:600}.text-blue-100{--tw-text-opacity:1;color:rgb(219 234 254 / var(--tw-text-opacity, 1))}.text-blue-500{--tw-text-opacity:1;color:rgb(59 130 246 / var(--tw-text-opacity, 1))}.text-emerald-500{--tw-text-opacity:1;color:rgb(16 185 129 / var(--tw-text-opacity, 1))}.text-gray-400{--tw-text-opacity:1;color:rgb(156 163 175 / var(--tw-text-opacity, 1))}.text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.text-gray-600{--tw-text-opacity:1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.text-gray-700{--tw-text-opacity:1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.text-gray-800{--tw-text-opacity:1;color:rgb(31 41 55 / var(--tw-text-opacity, 1))}.text-green-500{--tw-text-opacity:1;color:rgb(34 197 94 / var(--tw-text-opacity, 1))}.text-green-600{--tw-text-opacity:1;color:rgb(22 163 74 / var(--tw-text-opacity, 1))}.text-green-800{--tw-text-opacity:1;color:rgb(22 101 52 / var(--tw-text-opacity, 1))}.text-orange-500{--tw-text-opacity:1;color:rgb(249 115 22 / var(--tw-text-opacity, 1))}.text-purple-500{--tw-text-opacity:1;color:rgb(168 85 247 / var(--tw-text-opacity, 1))}.text-red-500{--tw-text-opacity:1;color:rgb(239 68 68 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.text-blue-600{--tw-text-opacity:1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.text-blue-800{--tw-text-opacity:1;color:rgb(30 64 175 / var(--tw-text-opacity, 1))}.text-orange-600{--tw-text-opacity:1;color:rgb(234 88 12 / var(--tw-text-opacity, 1))}.text-orange-800{--tw-text-opacity:1;color:rgb(154 52 18 / var(--tw-text-opacity, 1))}.text-purple-600{--tw-text-opacity:1;color:rgb(147 51 234 / var(--tw-text-opacity, 1))}.text-purple-800{--tw-text-opacity:1;color:rgb(107 33 168 / var(--tw-text-opacity, 1))}.text-amber-700{--tw-text-opacity:1;color:rgb(180 83 9 / var(--tw-text-opacity, 1))}.text-blue-700{--tw-text-opacity:1;color:rgb(29 78 216 / var(--tw-text-opacity, 1))}.text-green-700{--tw-text-opacity:1;color:rgb(21 128 61 / var(--tw-text-opacity, 1))}.text-orange-700{--tw-text-opacity:1;color:rgb(194 65 12 / var(--tw-text-opacity, 1))}.text-purple-700{--tw-text-opacity:1;color:rgb(126 34 206 / var(--tw-text-opacity, 1))}.shadow-2xl{--tw-shadow:0 25px 50px -12px rgb(0 0 0 / 0.25);--tw-shadow-colored:0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-lg{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-md{--tw-shadow:0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-sm{--tw-shadow:0 1px 2px 0 rgb(0 0 0 / 0.05);--tw-shadow-colored:0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-xl{--tw-shadow:0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.transition-colors{transition-property:color, background-color, border-color, fill, stroke, -webkit-text-decoration-color;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, -webkit-text-decoration-color;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.duration-300{transition-duration:300ms}.hover\:bg-blue-50:hover{--tw-bg-opacity:1;background-color:rgb(239 246 255 / var(--tw-bg-opacity, 1))}.hover\:bg-blue-700:hover{--tw-bg-opacity:1;background-color:rgb(29 78 216 / var(--tw-bg-opacity, 1))}.hover\:bg-emerald-50:hover{--tw-bg-opacity:1;background-color:rgb(236 253 245 / var(--tw-bg-opacity, 1))}.hover\:bg-gray-100:hover{--tw-bg-opacity:1;background-color:rgb(243 244 246 / var(--tw-bg-opacity, 1))}.hover\:bg-green-50:hover{--tw-bg-opacity:1;background-color:rgb(240 253 244 / var(--tw-bg-opacity, 1))}.hover\:bg-green-700:hover{--tw-bg-opacity:1;background-color:rgb(21 128 61 / var(--tw-bg-opacity, 1))}.hover\:bg-orange-50:hover{--tw-bg-opacity:1;background-color:rgb(255 247 237 / var(--tw-bg-opacity, 1))}.hover\:bg-purple-50:hover{--tw-bg-opacity:1;background-color:rgb(250 245 255 / var(--tw-bg-opacity, 1))}.hover\:bg-purple-700:hover{--tw-bg-opacity:1;background-color:rgb(126 34 206 / var(--tw-bg-opacity, 1))}.hover\:bg-red-50:hover{--tw-bg-opacity:1;background-color:rgb(254 242 242 / var(--tw-bg-opacity, 1))}.hover\:bg-red-700:hover{--tw-bg-opacity:1;background-color:rgb(185 28 28 / var(--tw-bg-opacity, 1))}.hover\:bg-white:hover{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.hover\:bg-blue-100:hover{--tw-bg-opacity:1;background-color:rgb(219 234 254 / var(--tw-bg-opacity, 1))}.hover\:bg-purple-100:hover{--tw-bg-opacity:1;background-color:rgb(243 232 255 / var(--tw-bg-opacity, 1))}.hover\:bg-blue-200:hover{--tw-bg-opacity:1;background-color:rgb(191 219 254 / var(--tw-bg-opacity, 1))}.hover\:bg-gray-300:hover{--tw-bg-opacity:1;background-color:rgb(209 213 219 / var(--tw-bg-opacity, 1))}.hover\:bg-purple-200:hover{--tw-bg-opacity:1;background-color:rgb(233 213 255 / var(--tw-bg-opacity, 1))}.hover\:bg-opacity-20:hover{--tw-bg-opacity:0.2}.hover\:bg-opacity-30:hover{--tw-bg-opacity:0.3}.hover\:text-gray-200:hover{--tw-text-opacity:1;color:rgb(229 231 235 / var(--tw-text-opacity, 1))}.hover\:text-gray-600:hover{--tw-text-opacity:1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.hover\:text-blue-800:hover{--tw-text-opacity:1;color:rgb(30 64 175 / var(--tw-text-opacity, 1))}.hover\:shadow-xl:hover{--tw-shadow:0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}@media (min-width: 640px){.sm\:mb-0{margin-bottom:0px}.sm\:mb-3{margin-bottom:0.75rem}.sm\:mb-4{margin-bottom:1rem}.sm\:mt-8{margin-top:2rem}.sm\:grid{display:grid}.sm\:max-h-\[90vh\]{max-height:90vh}.sm\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}.sm\:grid-cols-1{grid-template-columns:repeat(1, minmax(0, 1fr))}.sm\:flex-row{flex-direction:row}.sm\:items-center{align-items:center}.sm\:justify-between{justify-content:space-between}.sm\:gap-4{gap:1rem}.sm\:gap-6{gap:1.5rem}.sm\:space-x-3 > :not([hidden]) ~ :not([hidden]){--tw-space-x-reverse:0;margin-right:calc(0.75rem * var(--tw-space-x-reverse));margin-left:calc(0.75rem * calc(1 - var(--tw-space-x-reverse)))}.sm\:space-y-0 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0px * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0px * var(--tw-space-y-reverse))}.sm\:space-y-6 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1.5rem * var(--tw-space-y-reverse))}.sm\:space-x-reverse > :not([hidden]) ~ :not([hidden]){--tw-space-x-reverse:1}.sm\:self-center{align-self:center}.sm\:rounded-2xl{border-radius:1rem}.sm\:rounded-3xl{border-radius:1.5rem}.sm\:p-4{padding:1rem}.sm\:p-6{padding:1.5rem}.sm\:p-5{padding:1.25rem}.sm\:px-4{padding-left:1rem;padding-right:1rem}.sm\:px-6{padding-left:1.5rem;padding-right:1.5rem}.sm\:py-6{padding-top:1.5rem;padding-bottom:1.5rem}.sm\:py-8{padding-top:2rem;padding-bottom:2rem}.sm\:py-3{padding-top:0.75rem;padding-bottom:0.75rem}.sm\:pt-6{padding-top:1.5rem}.sm\:text-2xl{font-size:1.5rem;line-height:2rem}.sm\:text-3xl{font-size:1.875rem;line-height:2.25rem}.sm\:text-base{font-size:1rem;line-height:1.5rem}.sm\:text-lg{font-size:1.125rem;line-height:1.75rem}.sm\:text-xl{font-size:1.25rem;line-height:1.75rem}}@media (min-width: 768px){.md\:col-span-3{grid-column:span 3 / span 3}.md\:grid-cols-3{grid-template-columns:repeat(3, minmax(0, 1fr))}.md\:text-xl{font-size:1.25rem;line-height:1.75rem}}@media (min-width: 1024px){.lg\:mb-0{margin-bottom:0px}.lg\:grid-cols-5{grid-template-columns:repeat(5, minmax(0, 1fr))}.lg\:flex-row{flex-direction:row}.lg\:items-center{align-items:center}.lg\:justify-between{justify-content:space-between}}</style></head>
<body class="bg-gray-50 min-h-screen">
    <!-- Sidebar -->
    <div id="sidebar" class="sidebar fixed top-0 right-0 h-full w-80 bg-white shadow-2xl z-50 overflow-y-auto">
        <div class="p-6 border-b border-gray-200 bg-gradient-to-l from-blue-600 to-purple-600 text-white">
            <div class="flex justify-between items-center">
                <h2 class="text-xl font-bold">תפריט ניהול</h2>
                <button id="closeSidebar" class="text-white hover:text-gray-200 text-2xl font-bold p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-all">
                    ×
                </button>
            </div>
        </div>
        
        <!-- Login Section -->
        <div class="p-4 border-b border-gray-200">
            <div id="loginSection">
                <button id="loginBtn" class="w-full bg-blue-600 text-white px-3 py-2 rounded-2xl text-sm font-medium hover:bg-blue-700 transition-colors shadow-md flex items-center justify-center">
                    <span class="ml-2">🔐</span>
                    <span>כניסה למנהל</span>
                </button>
            </div>
            <div id="userInfo" class="hidden">
                <div class="bg-green-50 p-4 rounded-2xl border border-green-200">
                    <div class="flex items-center justify-between mb-3">
                        <div>
                            <div class="text-green-800 font-medium">מנהל המערכת</div>
                            <div class="text-green-600 text-sm">גישה מלאה</div>
                        </div>
                        <span class="text-green-500 text-2xl">✅</span>
                    </div>
                    <div class="space-y-2">
                        <button id="editContentBtn" class="w-full bg-purple-600 text-white px-4 py-2 rounded-2xl text-sm hover:bg-purple-700 transition-colors">
                            ✏️ עריכת תוכן
                        </button>
                        <button onclick="refreshDataFromCMS()" class="w-full bg-blue-600 text-white px-4 py-2 rounded-2xl text-sm hover:bg-blue-700 transition-colors">
                            🔄 רענן נתונים
                        </button>
                        <button onclick="exportToCMSFormat()" class="w-full bg-green-600 text-white px-4 py-2 rounded-2xl text-sm hover:bg-green-700 transition-colors">
                            📥 ייצא נתונים
                        </button>
                        <button id="logoutBtn" class="w-full bg-red-600 text-white px-4 py-2 rounded-2xl text-sm hover:bg-red-700 transition-colors">
                            יציאה
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <nav class="p-4">
            <ul class="space-y-2">
                <li>
                    <button onclick="showPage('events')" class="nav-item w-full text-right p-4 rounded-2xl hover:bg-blue-50 transition-all flex items-center">
                        <span class="text-blue-500 ml-3 text-xl">📅</span>
                        <span class="font-medium">אירועים</span>
                    </button>
                </li>
                <li>
                    <button onclick="showPage('prayer-songs')" class="nav-item w-full text-right p-4 rounded-2xl hover:bg-purple-50 transition-all flex items-center">
                        <span class="text-purple-500 ml-3 text-xl">🎵</span>
                        <span class="font-medium">שירי תפילה</span>
                    </button>
                </li>
                <li>
                    <button onclick="showPage('meal-songs')" class="nav-item w-full text-right p-4 rounded-2xl hover:bg-green-50 transition-all flex items-center">
                        <span class="text-green-500 ml-3 text-xl">🍽️</span>
                        <span class="font-medium">שירי סעודה</span>
                    </button>
                </li>
                <li id="adminSection" class="border-t border-gray-200 pt-4 mt-4 hidden">
                    <div class="text-gray-500 text-sm font-medium mb-2 px-4">אזור אישי</div>
                    <button onclick="showPage('admin')" class="nav-item w-full text-right p-4 rounded-2xl hover:bg-orange-50 transition-all flex items-center">
                        <span class="text-orange-500 ml-3 text-xl">👤</span>
                        <span class="font-medium">ניהול תלמידים</span>
                    </button>
                </li>
                <li id="equipmentSection" class="hidden">
                    <button onclick="showPage('equipment')" class="nav-item w-full text-right p-4 rounded-2xl hover:bg-red-50 transition-all flex items-center">
                        <span class="text-red-500 ml-3 text-xl">🎤</span>
                        <span class="font-medium">צ'קליסט ציוד</span>
                    </button>
                </li>
                <li id="paymentsSection" class="hidden">
                    <button onclick="showPage('payments')" class="nav-item w-full text-right p-4 rounded-2xl hover:bg-emerald-50 transition-all flex items-center">
                        <span class="text-emerald-500 ml-3 text-xl">💰</span>
                        <span class="font-medium">מעקב תשלומים</span>
                    </button>
                </li>
            </ul>
        </nav>
    </div>

    <!-- Overlay -->
    <div id="overlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden" onclick="closeSidebar()"></div>

    <!-- Header -->
    <header class="gradient-header text-white shadow-lg">
        <div class="container mx-auto px-4 sm:px-6 py-4 sm:py-6">
            <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
                <div class="mb-4 sm:mb-0">
                    <h1 class="text-2xl sm:text-3xl font-bold mb-1">מערכת ניהול אירועי בר מצווה</h1>
                    <p class="text-blue-100 text-sm sm:text-lg">ניהול תפילה • לימוד • שירים ופיוטים</p>
                </div>
                <div class="flex items-center space-x-3 space-x-reverse">
                    <button id="installApp" class="bg-green-600 text-white px-4 py-2 rounded-2xl hover:bg-green-700 transition-all flex items-center hidden">
                        <span class="ml-2">📱</span>
                        <span>התקן אפליקציה</span>
                    </button>
                    <button id="menuBtn" class="bg-white bg-opacity-20 text-white px-4 py-2 rounded-2xl hover:bg-opacity-30 transition-all flex items-center">
                        <span class="ml-2">☰</span>
                        <span>תפריט</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 sm:px-6 py-6 sm:py-8">
        <!-- Events Page -->
        <div id="events-page" class="page">
            <div class="bg-white rounded-3xl shadow-lg border border-gray-100">
                <div class="bg-gradient-to-l from-blue-50 to-indigo-50 border-b border-gray-200 p-4 sm:p-6 rounded-t-3xl">
                    <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
                        <div class="mb-4 sm:mb-0">
                            <h2 class="text-xl sm:text-2xl font-bold text-gray-800 mb-1">אירועים קרובים</h2>
                            <p class="text-gray-600 text-sm sm:text-base">זמני הגעת האורחים וזמני תחילת האירוע</p>
                        </div>
                        <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3 sm:space-x-reverse">
                            <select id="packageFilter" class="border border-gray-300 rounded-2xl px-3 sm:px-4 py-2 text-gray-700 bg-white shadow-sm text-sm sm:text-base">
                                <option value="">כל החבילות</option>
                                <option value="חבילה בסיסית">חבילה בסיסית</option>
                                <option value="חבילה חגיגית">חבילה חגיגית</option>
                                <option value="חבילת הכל כלול">חבילת הכל כלול</option>
                            </select>
                            <select id="keyboardistFilter" class="border border-gray-300 rounded-2xl px-3 sm:px-4 py-2 text-gray-700 bg-white shadow-sm text-sm sm:text-base">
                                <option value="">כל האירועים</option>
                                <option value="true">עם קלידן</option>
                                <option value="false">ללא קלידן</option>
                            </select>
                            <select id="drummersFilter" class="border border-gray-300 rounded-2xl px-3 sm:px-4 py-2 text-gray-700 bg-white shadow-sm text-sm sm:text-base">
                                <option value="">כל האירועים</option>
                                <option value="true">עם מתופפים</option>
                                <option value="false">ללא מתופפים</option>
                            </select>
                            <button id="addEventBtn" class="bg-blue-600 text-white px-4 sm:px-6 py-2 rounded-2xl hover:bg-blue-700 transition-colors font-medium shadow-md text-sm sm:text-base hidden" onclick="addNewEvent()">
                                ➕ הוסף אירוע
                            </button>
                        </div>
                    </div>
                </div>

                <div class="p-4 sm:p-6 space-y-4 sm:space-y-6" id="eventsContainer">
                    <div class="bg-white border border-gray-200 rounded-3xl shadow-lg hover:shadow-xl transition-all duration-300 cursor-pointer overflow-hidden" onclick="openEventModal(1)">
                        <!-- Gradient Header -->
                        <div class="card-gradient-1 p-4 text-white">
                            <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
                                <div class="flex items-center mb-2 sm:mb-0">
                                    <span class="status-indicator bg-green-500 ml-3 bg-white bg-opacity-80"></span>
                                    <h3 class="text-lg sm:text-xl font-bold">בר מצווה - עידן שוסטר</h3>
                                </div>
                                <span class="bg-white bg-opacity-20 text-white px-3 py-1 rounded-full text-xs font-medium self-start sm:self-center">תלמיד פרטי</span>
                            </div>
                        </div>

                        <!-- Content -->
                        <div class="p-4 sm:p-5">
                            <div class="flex flex-col lg:flex-row lg:justify-between lg:items-center">
                                <div class="flex-1 mb-4 lg:mb-0">
                                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3 text-gray-600">
                                        <div class="bg-blue-50 p-3 rounded-2xl border border-blue-200 cursor-pointer hover:bg-blue-100 transition-colors" onclick="event.stopPropagation(); addToGoogleCalendar(1)">
                                            <div class="flex items-center">
                                                <span class="text-blue-600 ml-2 text-lg">📅</span>
                                                <div class="flex flex-col">
                                                    <span class="text-xs text-blue-600 font-medium">תאריך</span>
                                                    <span class="font-bold text-blue-800 text-sm">24 ביולי 2025</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="bg-green-50 p-3 rounded-2xl border border-green-200">
                                            <div class="flex items-center">
                                                <span class="text-green-600 ml-2 text-lg">👥</span>
                                                <div class="flex flex-col">
                                                    <span class="text-xs text-green-600 font-medium">הגעת אורחים</span>
                                                    <span class="font-bold text-green-800 text-sm">08:00</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="bg-orange-50 p-3 rounded-2xl border border-orange-200">
                                            <div class="flex items-center">
                                                <span class="text-orange-600 ml-2 text-lg">🎉</span>
                                                <div class="flex flex-col">
                                                    <span class="text-xs text-orange-600 font-medium">תחילת אירוע</span>
                                                    <span class="font-bold text-orange-800 text-sm">08:30-09:00</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="bg-purple-50 p-3 rounded-2xl border border-purple-200 cursor-pointer hover:bg-purple-100 transition-colors" onclick="event.stopPropagation(); openWaze('https://waze.com/ul?q=בית הכנסת זכור לאברהם אחוזת ברק')">
                                            <div class="flex items-center">
                                                <span class="text-purple-600 ml-2 text-lg">📍</span>
                                                <div class="flex flex-col flex-1">
                                                    <span class="text-xs text-purple-600 font-medium">מיקום</span>
                                                    <span class="font-bold text-purple-800 text-sm text-right truncate">
                                                        בית הכנסת זכור לאברהם אחוזת ברק
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="flex flex-col sm:flex-row items-start sm:items-center space-y-2 sm:space-y-0 sm:space-x-3 sm:space-x-reverse">
                                    
                                    <div class="flex items-center text-blue-600 hover:text-blue-800 font-medium text-sm bg-blue-50 px-3 py-2 rounded-2xl hover:bg-blue-100 transition-colors">
                                        <span>פרטים נוספים</span>
                                        <span class="mr-2">←</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                
                    <div class="bg-white border border-gray-200 rounded-3xl shadow-lg hover:shadow-xl transition-all duration-300 cursor-pointer overflow-hidden" onclick="openEventModal(2)">
                        <!-- Gradient Header -->
                        <div class="card-gradient-2 p-4 text-white">
                            <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
                                <div class="flex items-center mb-2 sm:mb-0">
                                    <span class="status-indicator bg-green-500 ml-3 bg-white bg-opacity-80"></span>
                                    <h3 class="text-lg sm:text-xl font-bold">בר מצווה - יגל כהן</h3>
                                </div>
                                
                            </div>
                        </div>

                        <!-- Content -->
                        <div class="p-4 sm:p-5">
                            <div class="flex flex-col lg:flex-row lg:justify-between lg:items-center">
                                <div class="flex-1 mb-4 lg:mb-0">
                                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3 text-gray-600">
                                        <div class="bg-blue-50 p-3 rounded-2xl border border-blue-200 cursor-pointer hover:bg-blue-100 transition-colors" onclick="event.stopPropagation(); addToGoogleCalendar(2)">
                                            <div class="flex items-center">
                                                <span class="text-blue-600 ml-2 text-lg">📅</span>
                                                <div class="flex flex-col">
                                                    <span class="text-xs text-blue-600 font-medium">תאריך</span>
                                                    <span class="font-bold text-blue-800 text-sm">30 ביולי 2025</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="bg-green-50 p-3 rounded-2xl border border-green-200">
                                            <div class="flex items-center">
                                                <span class="text-green-600 ml-2 text-lg">👥</span>
                                                <div class="flex flex-col">
                                                    <span class="text-xs text-green-600 font-medium">הגעת אורחים</span>
                                                    <span class="font-bold text-green-800 text-sm">08:30</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="bg-orange-50 p-3 rounded-2xl border border-orange-200">
                                            <div class="flex items-center">
                                                <span class="text-orange-600 ml-2 text-lg">🎉</span>
                                                <div class="flex flex-col">
                                                    <span class="text-xs text-orange-600 font-medium">תחילת אירוע</span>
                                                    <span class="font-bold text-orange-800 text-sm">09:00</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="bg-purple-50 p-3 rounded-2xl border border-purple-200 cursor-pointer hover:bg-purple-100 transition-colors" onclick="event.stopPropagation(); openWaze('https://waze.com/ul?q=בית כנסת אוהל ציון, הבוכרים 3 עפולה')">
                                            <div class="flex items-center">
                                                <span class="text-purple-600 ml-2 text-lg">📍</span>
                                                <div class="flex flex-col flex-1">
                                                    <span class="text-xs text-purple-600 font-medium">מיקום</span>
                                                    <span class="font-bold text-purple-800 text-sm text-right truncate">
                                                        בית כנסת אוהל ציון, הבוכרים 3 עפולה
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="flex flex-col sm:flex-row items-start sm:items-center space-y-2 sm:space-y-0 sm:space-x-3 sm:space-x-reverse">
                                    
                                    <div class="flex items-center text-blue-600 hover:text-blue-800 font-medium text-sm bg-blue-50 px-3 py-2 rounded-2xl hover:bg-blue-100 transition-colors">
                                        <span>פרטים נוספים</span>
                                        <span class="mr-2">←</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                
                    <div class="bg-white border border-gray-200 rounded-3xl shadow-lg hover:shadow-xl transition-all duration-300 cursor-pointer overflow-hidden" onclick="openEventModal(3)">
                        <!-- Gradient Header -->
                        <div class="card-gradient-3 p-4 text-white">
                            <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
                                <div class="flex items-center mb-2 sm:mb-0">
                                    <span class="status-indicator bg-green-500 ml-3 bg-white bg-opacity-80"></span>
                                    <h3 class="text-lg sm:text-xl font-bold">בר מצווה - אדווה</h3>
                                </div>
                                <span class="bg-white bg-opacity-20 text-white px-3 py-1 rounded-full text-xs font-medium self-start sm:self-center">תלמיד פרטי</span>
                            </div>
                        </div>

                        <!-- Content -->
                        <div class="p-4 sm:p-5">
                            <div class="flex flex-col lg:flex-row lg:justify-between lg:items-center">
                                <div class="flex-1 mb-4 lg:mb-0">
                                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3 text-gray-600">
                                        <div class="bg-blue-50 p-3 rounded-2xl border border-blue-200 cursor-pointer hover:bg-blue-100 transition-colors" onclick="event.stopPropagation(); addToGoogleCalendar(3)">
                                            <div class="flex items-center">
                                                <span class="text-blue-600 ml-2 text-lg">📅</span>
                                                <div class="flex flex-col">
                                                    <span class="text-xs text-blue-600 font-medium">תאריך</span>
                                                    <span class="font-bold text-blue-800 text-sm">25 באוגוסט 2025</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="bg-green-50 p-3 rounded-2xl border border-green-200">
                                            <div class="flex items-center">
                                                <span class="text-green-600 ml-2 text-lg">👥</span>
                                                <div class="flex flex-col">
                                                    <span class="text-xs text-green-600 font-medium">הגעת אורחים</span>
                                                    <span class="font-bold text-green-800 text-sm">00:00</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="bg-orange-50 p-3 rounded-2xl border border-orange-200">
                                            <div class="flex items-center">
                                                <span class="text-orange-600 ml-2 text-lg">🎉</span>
                                                <div class="flex flex-col">
                                                    <span class="text-xs text-orange-600 font-medium">תחילת אירוע</span>
                                                    <span class="font-bold text-orange-800 text-sm">00:00</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="bg-purple-50 p-3 rounded-2xl border border-purple-200 cursor-pointer hover:bg-purple-100 transition-colors" onclick="event.stopPropagation(); openWaze('https://waze.com/ul?q=ראש פינה')">
                                            <div class="flex items-center">
                                                <span class="text-purple-600 ml-2 text-lg">📍</span>
                                                <div class="flex flex-col flex-1">
                                                    <span class="text-xs text-purple-600 font-medium">מיקום</span>
                                                    <span class="font-bold text-purple-800 text-sm text-right truncate">
                                                        ראש פינה
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="flex flex-col sm:flex-row items-start sm:items-center space-y-2 sm:space-y-0 sm:space-x-3 sm:space-x-reverse">
                                    
                                    <div class="flex items-center text-blue-600 hover:text-blue-800 font-medium text-sm bg-blue-50 px-3 py-2 rounded-2xl hover:bg-blue-100 transition-colors">
                                        <span>פרטים נוספים</span>
                                        <span class="mr-2">←</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                
                    <div class="bg-white border border-gray-200 rounded-3xl shadow-lg hover:shadow-xl transition-all duration-300 cursor-pointer overflow-hidden" onclick="openEventModal(4)">
                        <!-- Gradient Header -->
                        <div class="card-gradient-4 p-4 text-white">
                            <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
                                <div class="flex items-center mb-2 sm:mb-0">
                                    <span class="status-indicator bg-green-500 ml-3 bg-white bg-opacity-80"></span>
                                    <h3 class="text-lg sm:text-xl font-bold">בר מצווה - ריף הרשקוביץ'</h3>
                                </div>
                                <span class="bg-white bg-opacity-20 text-white px-3 py-1 rounded-full text-xs font-medium self-start sm:self-center">תלמיד פרטי</span>
                            </div>
                        </div>

                        <!-- Content -->
                        <div class="p-4 sm:p-5">
                            <div class="flex flex-col lg:flex-row lg:justify-between lg:items-center">
                                <div class="flex-1 mb-4 lg:mb-0">
                                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3 text-gray-600">
                                        <div class="bg-blue-50 p-3 rounded-2xl border border-blue-200 cursor-pointer hover:bg-blue-100 transition-colors" onclick="event.stopPropagation(); addToGoogleCalendar(4)">
                                            <div class="flex items-center">
                                                <span class="text-blue-600 ml-2 text-lg">📅</span>
                                                <div class="flex flex-col">
                                                    <span class="text-xs text-blue-600 font-medium">תאריך</span>
                                                    <span class="font-bold text-blue-800 text-sm">23 באוקטובר 2025</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="bg-green-50 p-3 rounded-2xl border border-green-200">
                                            <div class="flex items-center">
                                                <span class="text-green-600 ml-2 text-lg">👥</span>
                                                <div class="flex flex-col">
                                                    <span class="text-xs text-green-600 font-medium">הגעת אורחים</span>
                                                    <span class="font-bold text-green-800 text-sm">00:00</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="bg-orange-50 p-3 rounded-2xl border border-orange-200">
                                            <div class="flex items-center">
                                                <span class="text-orange-600 ml-2 text-lg">🎉</span>
                                                <div class="flex flex-col">
                                                    <span class="text-xs text-orange-600 font-medium">תחילת אירוע</span>
                                                    <span class="font-bold text-orange-800 text-sm">00:00</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="bg-purple-50 p-3 rounded-2xl border border-purple-200 cursor-pointer hover:bg-purple-100 transition-colors" onclick="event.stopPropagation(); openWaze('https://waze.com/ul?q=זכרון יעקוב')">
                                            <div class="flex items-center">
                                                <span class="text-purple-600 ml-2 text-lg">📍</span>
                                                <div class="flex flex-col flex-1">
                                                    <span class="text-xs text-purple-600 font-medium">מיקום</span>
                                                    <span class="font-bold text-purple-800 text-sm text-right truncate">
                                                        זכרון יעקב
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="flex flex-col sm:flex-row items-start sm:items-center space-y-2 sm:space-y-0 sm:space-x-3 sm:space-x-reverse">
                                    
                                    <div class="flex items-center text-blue-600 hover:text-blue-800 font-medium text-sm bg-blue-50 px-3 py-2 rounded-2xl hover:bg-blue-100 transition-colors">
                                        <span>פרטים נוספים</span>
                                        <span class="mr-2">←</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                
                    <div class="bg-white border border-gray-200 rounded-3xl shadow-lg hover:shadow-xl transition-all duration-300 cursor-pointer overflow-hidden" onclick="openEventModal(5)">
                        <!-- Gradient Header -->
                        <div class="card-gradient-5 p-4 text-white">
                            <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
                                <div class="flex items-center mb-2 sm:mb-0">
                                    <span class="status-indicator bg-green-500 ml-3 bg-white bg-opacity-80"></span>
                                    <h3 class="text-lg sm:text-xl font-bold">בר מצווה - חגי סויהלמן</h3>
                                </div>
                                
                            </div>
                        </div>

                        <!-- Content -->
                        <div class="p-4 sm:p-5">
                            <div class="flex flex-col lg:flex-row lg:justify-between lg:items-center">
                                <div class="flex-1 mb-4 lg:mb-0">
                                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3 text-gray-600">
                                        <div class="bg-blue-50 p-3 rounded-2xl border border-blue-200 cursor-pointer hover:bg-blue-100 transition-colors" onclick="event.stopPropagation(); addToGoogleCalendar(5)">
                                            <div class="flex items-center">
                                                <span class="text-blue-600 ml-2 text-lg">📅</span>
                                                <div class="flex flex-col">
                                                    <span class="text-xs text-blue-600 font-medium">תאריך</span>
                                                    <span class="font-bold text-blue-800 text-sm">30 באוקטובר 2025</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="bg-green-50 p-3 rounded-2xl border border-green-200">
                                            <div class="flex items-center">
                                                <span class="text-green-600 ml-2 text-lg">👥</span>
                                                <div class="flex flex-col">
                                                    <span class="text-xs text-green-600 font-medium">הגעת אורחים</span>
                                                    <span class="font-bold text-green-800 text-sm">08:00</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="bg-orange-50 p-3 rounded-2xl border border-orange-200">
                                            <div class="flex items-center">
                                                <span class="text-orange-600 ml-2 text-lg">🎉</span>
                                                <div class="flex flex-col">
                                                    <span class="text-xs text-orange-600 font-medium">תחילת אירוע</span>
                                                    <span class="font-bold text-orange-800 text-sm">08:30-09:00</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="bg-purple-50 p-3 rounded-2xl border border-purple-200 cursor-pointer hover:bg-purple-100 transition-colors" onclick="event.stopPropagation(); openWaze('https://waze.com/ul?q=בית כנסת זכור לאברהם אחוזת ברק')">
                                            <div class="flex items-center">
                                                <span class="text-purple-600 ml-2 text-lg">📍</span>
                                                <div class="flex flex-col flex-1">
                                                    <span class="text-xs text-purple-600 font-medium">מיקום</span>
                                                    <span class="font-bold text-purple-800 text-sm text-right truncate">
                                                        בית כנסת זכור לאברהם אחוזת ברק
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="flex flex-col sm:flex-row items-start sm:items-center space-y-2 sm:space-y-0 sm:space-x-3 sm:space-x-reverse">
                                    
                                    <div class="flex items-center text-blue-600 hover:text-blue-800 font-medium text-sm bg-blue-50 px-3 py-2 rounded-2xl hover:bg-blue-100 transition-colors">
                                        <span>פרטים נוספים</span>
                                        <span class="mr-2">←</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Prayer Songs Page -->
        <div id="prayer-songs-page" class="page hidden">
            <div class="bg-white rounded-3xl shadow-lg border border-gray-100">
                <div class="bg-gradient-to-l from-purple-50 to-pink-50 border-b border-gray-200 p-4 sm:p-6 rounded-t-3xl">
                    <h2 class="text-xl sm:text-2xl font-bold text-gray-800 mb-1">שירי תפילה</h2>
                    <p class="text-gray-600 text-sm sm:text-base">רשימת השירים לחלק התפילה בבר המצווה</p>
                </div>
                <div class="p-4 sm:p-6 space-y-4" id="prayerSongsContainer">
                    <!-- Prayer songs will be populated here -->
                </div>
            </div>
        </div>

        <!-- Meal Songs Page -->
        <div id="meal-songs-page" class="page hidden">
            <div class="bg-white rounded-3xl shadow-lg border border-gray-100">
                <div class="bg-gradient-to-l from-green-50 to-emerald-50 border-b border-gray-200 p-4 sm:p-6 rounded-t-3xl">
                    <h2 class="text-xl sm:text-2xl font-bold text-gray-800 mb-1">שירי סעודה</h2>
                    <p class="text-gray-600 text-sm sm:text-base">רשימת השירים לחלק הסעודה בבר המצווה</p>
                </div>
                <div class="p-4 sm:p-6 space-y-4" id="mealSongsContainer">
                    <!-- Meal songs will be populated here -->
                </div>
            </div>
        </div>

        <!-- Admin Page -->
        <div id="admin-page" class="page hidden">
            <div class="bg-white rounded-3xl shadow-lg border border-gray-100">
                <div class="bg-gradient-to-l from-orange-50 to-red-50 border-b border-gray-200 p-4 sm:p-6 rounded-t-3xl">
                    <h2 class="text-xl sm:text-2xl font-bold text-gray-800 mb-1">ניהול תלמידים</h2>
                    <p class="text-gray-600 text-sm sm:text-base">מעקב אחר התקדמות התלמידים</p>
                </div>
                <div class="divide-y divide-gray-200" id="studentsContainer">
                    <!-- Student items will be populated here -->
                </div>
            </div>
        </div>

        <!-- Equipment Page -->
        <div id="equipment-page" class="page hidden">
            <div class="bg-white rounded-3xl shadow-lg border border-gray-100">
                <div class="bg-gradient-to-l from-red-50 to-pink-50 border-b border-gray-200 p-4 sm:p-6 rounded-t-3xl">
                    <h2 class="text-xl sm:text-2xl font-bold text-gray-800 mb-1">צ'קליסט ציוד</h2>
                    <p class="text-gray-600 text-sm sm:text-base">רשימת ציוד נדרש לאירוע</p>
                </div>
                <div class="p-4 sm:p-6" id="equipmentContainer">
                    <!-- Equipment checklist will be populated here -->
                </div>
            </div>
        </div>

        <!-- Payments Page -->
        <div id="payments-page" class="page hidden">
            <div class="bg-white rounded-3xl shadow-lg border border-gray-100">
                <div class="bg-gradient-to-l from-emerald-50 to-teal-50 border-b border-gray-200 p-4 sm:p-6 rounded-t-3xl">
                    <h2 class="text-xl sm:text-2xl font-bold text-gray-800 mb-1">מעקב תשלומים</h2>
                    <p class="text-gray-600 text-sm sm:text-base">מעקב אחר תשלומים לקלידן, מתופפים וקבלות</p>
                </div>
                <div class="p-4 sm:p-6" id="paymentsContainer">
                    <!-- Payments tracking will be populated here -->
                </div>
            </div>
        </div>
    </main>

    <!-- Event Modal -->
    <div id="eventModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2 sm:p-4 hidden">
        <div class="bg-white rounded-3xl shadow-xl max-w-4xl w-full max-h-[95vh] sm:max-h-[90vh] overflow-y-auto">
            <div class="border-b border-gray-200 p-3 sm:p-6 sticky top-0 bg-white rounded-t-3xl">
                <div class="flex justify-between items-center">
                    <h3 class="text-base sm:text-lg md:text-xl font-bold text-gray-800" id="modalTitle">בר מצווה - חגי סויהלמן</h3>
                    <button id="closeModal" class="text-gray-400 hover:text-gray-600 text-xl sm:text-2xl font-bold p-1 rounded-full hover:bg-gray-100 transition-all">×</button>
                </div>
            </div>
            <div class="p-3 sm:p-6" id="modalContent">
                <div class="space-y-4 sm:space-y-6">
                    <!-- Basic Event Info -->
                    <div class="bg-gradient-to-l from-blue-50 to-indigo-50 p-4 sm:p-6 rounded-2xl sm:rounded-3xl border border-blue-100">
                        <h4 class="text-base sm:text-lg font-semibold text-gray-800 mb-3 sm:mb-4">פרטי האירוע</h4>
                        <div class="space-y-3 sm:space-y-0 sm:grid sm:grid-cols-1 md:grid-cols-3 sm:gap-4">
                            <div class="bg-blue-100 p-3 rounded-xl border border-blue-200 cursor-pointer hover:bg-blue-200 transition-colors" onclick="addToGoogleCalendar(5)">
                                <div class="flex items-center">
                                    <span class="text-blue-600 ml-2 text-lg">📅</span>
                                    <div>
                                        <span class="font-medium text-blue-800 text-sm">תאריך:</span>
                                        <div class="text-blue-700 font-bold text-sm">יום חמישי, 30 באוקטובר 2025</div>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-green-100 p-3 rounded-xl border border-green-200">
                                <div class="flex items-center">
                                    <span class="text-green-600 ml-2 text-lg">👥</span>
                                    <div>
                                        <span class="font-medium text-green-800 text-sm">הגעת אורחים:</span>
                                        <div class="text-green-700 font-bold text-sm">08:00</div>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-orange-100 p-3 rounded-xl border border-orange-200">
                                <div class="flex items-center">
                                    <span class="text-orange-600 ml-2 text-lg">🎉</span>
                                    <div>
                                        <span class="font-medium text-orange-800 text-sm">תחילת אירוע:</span>
                                        <div class="text-orange-700 font-bold text-sm">08:30-09:00</div>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-purple-100 p-3 rounded-xl border border-purple-200 md:col-span-3 cursor-pointer hover:bg-purple-200 transition-colors" onclick="openWaze('https://waze.com/ul?q=בית כנסת זכור לאברהם אחוזת ברק')">
                                <div class="flex items-center">
                                    <span class="text-purple-600 ml-2 text-lg">📍</span>
                                    <div class="flex-1">
                                        <span class="font-medium text-purple-800 text-sm">מיקום:</span>
                                        <div class="flex items-center justify-between">
                                            <div class="text-purple-700 font-bold text-sm flex-1">בית כנסת זכור לאברהם אחוזת ברק</div>
                                            
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Package and Music -->
                    <div class="grid grid-cols-1 gap-4 sm:gap-6">
                        <div>
                            <h4 class="text-base sm:text-lg font-semibold text-gray-800 mb-2 sm:mb-3">חבילת השירות</h4>
                            <div class="inline-block px-3 sm:px-4 py-2 sm:py-3 rounded-xl sm:rounded-2xl border bg-amber-50 text-amber-700 border-amber-200 font-medium text-sm sm:text-base">
                                חבילת הכל כלול
                            </div>
                        </div>
                        
                        <div>
                            <h4 class="text-base sm:text-lg font-semibold text-gray-800 mb-2 sm:mb-3">ליווי מוזיקלי</h4>
                            <div class="bg-gray-50 p-3 sm:p-4 rounded-xl sm:rounded-2xl">
                                <div class="flex items-center">
                                    <span class="text-orange-500 ml-2">🎵</span>
                                    <span class="text-gray-700 text-sm sm:text-base">קלידן + 2 מתופפים</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    
                </div>
                
                <div class="flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-3 sm:space-x-reverse mt-6 sm:mt-8 pt-4 sm:pt-6 border-t border-gray-200">
                    <button class="px-4 sm:px-6 py-2 bg-gray-200 text-gray-700 rounded-xl sm:rounded-2xl hover:bg-gray-300 transition-colors font-medium text-sm sm:text-base" onclick="document.getElementById('eventModal').classList.add('hidden')">
                        סגור
                    </button>
                    
                </div>
            </div>
        </div>
    </div>

  <script>
    // Sample data
    const events = [
        {
            id: 1,
            name: "עידן שוסטר",
            date: "2025-07-24",
            time: "10:00",
            guestArrivalTime: "08:00",
            eventStartTime: "08:30-09:00",
            location: "בית הכנסת זכור לאברהם אחוזת ברק",
            wazeLink: "https://waze.com/ul?q=בית הכנסת זכור לאברהם אחוזת ברק",
            package: "חבילה חגיגית",
            keyboardist: true,
            drummers: 2,
            isStudent: true,
            price: 4500,
            parentPhone: "050-3575386",
            parentName: "יפעת שוסטר",
            notes: " ",
            status: "confirmed"
        },
        {
            id: 2,
            name: "יגל כהן",
            date: "2025-07-30",
            guestArrivalTime: "08:30",
            eventStartTime: "09:00",
            location: "בית כנסת אוהל ציון, הבוכרים 3 עפולה",
            wazeLink: "https://waze.com/ul?q=בית כנסת אוהל ציון, הבוכרים 3 עפולה",
            package: "חבילה בסיסית",
            keyboardist: true,
            drummers: 0,
            isStudent: false,
            price: 2000,
            parentPhone: "052-9876543",
            parentName: "גיא כהן",
            notes: "תפילה וקלידן בלבד, ללא מתופפים",
            status: "confirmed"
        },
        {
            id: 3,
            name: "אדווה",
            date: "2025-08-25",
            guestArrivalTime: "00:00",
            eventStartTime: "00:00",
            location: "ראש פינה",
            wazeLink: "https://waze.com/ul?q=ראש פינה",
            package: "חבילת הכל כלול",
            keyboardist: true,
            drummers: 2,
            isStudent: true,
            price: 2800,
            parentPhone: "050-7764145",
            parentName: "אדווה",
            notes: "",
            status: "confirmed"
        },
        {
            id: 4,
            name: "ריף הרשקוביץ'",
            date: "2025-10-23",
            guestArrivalTime: "00:00",
            eventStartTime: "00:00",
            location: "זכרון יעקב",
            wazeLink: "https://waze.com/ul?q=זכרון יעקוב",
            package: "חבילת הכל כלול",
            keyboardist: true,
            drummers: 0,
            isStudent: true,
            price: 0000,
            parentPhone: "052-2302619",
            parentName: "מיטל הרשקוביץ'",
            notes: " רק קלידן בלי מתופפים",
            status: "confirmed"
        },
        {
            id: 5,
            name: "חגי סויהלמן",
            date: "2025-10-30",
            guestArrivalTime: "08:00",
            eventStartTime: "08:30-09:00",
            location: "בית כנסת זכור לאברהם אחוזת ברק",
            wazeLink: "https://waze.com/ul?q=בית כנסת זכור לאברהם אחוזת ברק",
            package: "חבילת הכל כלול",
            keyboardist: true,
            drummers: 2,
            isStudent: false,
            price: 5000,
            parentPhone: "052-2302619",
            parentName: "חגי סויהלמן",
            notes: " ייתכן באוכל רוצה רק שירי רקע במקום הופעה",
            status: "confirmed"
        }
    ];

    const students = [
        {
            id: 1,
            name: "עידן שוסטר",
            eventDate: "2025-07-24",
            lessonsCompleted: 0,
            totalLessons: 0,
            nextLesson: "2024-01-10",
            phone: "050-1234567",
            progress: "מתקדם מצוין, מוכן לקריאה בתורה",
            parsha: "פרשת וירא",
            readingType: "עליית ראשון + מפטיר",
            hasRecording: true,
            recordingNotes: "הקלטה של הפרשה והפטרה",
            haftarah: "מלכים א יח:כ-לט",
            torahPortion: "בראשית כב:א-יט",
            specialNotes: "יודע לקרוא עם טעמים, קול יפה"
        },
        {
            id: 2,
            name: "אבי רוזן",
            eventDate: "2024-01-22",
            lessonsCompleted: 6,
            totalLessons: 15,
            nextLesson: "2024-01-12",
            phone: "054-5555555",
            progress: "צריך עבודה נוספת על הפטרה",
            parsha: "פרשת חיי שרה",
            readingType: "עליית ראשון בלבד",
            hasRecording: false,
            recordingNotes: "עדיין לא מוכן להקלטה",
            haftarah: "מלכים א א:א-לא",
            torahPortion: "בראשית כג:א-כ",
            specialNotes: "קושי בטעמים, צריך תרגול נוסף"
        }
    ];

    const prayerSongs = [
        {
            id: 1,
            name: "כניסה בחוץ- שמע ישראל+ השם הוא האלוקים (פד מרגש ושופרות)",
            key: "Am",
            tempo: 0,
            transpose: 0,
            chords: "אין",
            lyrics: `שמע ישראל השם אלוהינו השם אחד+השם הוא האלוקים`
        },
        {
            id: 2,
            name: "ישמח חתני",
            key: "Am",
            tempo: 110,
            transpose: 0,
            chords: "אין צורך",
            lyrics: `ישמח חתני בקהל אמוני
ישא ברכה מאת אמוניי

שדי ימלא תאות ליבו
מגן וצינה יהיה סביבו
ויאר אותו ויישר נתיבו
לגמור ולשמור דרכי אמוניי

ישמח חתני...

לראשו יצוה ברכות עצומות
ויסע בכל עת כנהר שלומות
באיבא ברינה נושא אלומות
יזכה ויראה ישועת אמוניי

ישמח חתני...`
        },
        {
            id: 3,
            name: "יברכך השם מציון",
            key: "Am",
            tempo: 110,
            transpose: 7,
            chords: "אין צורך",
            lyrics: `
יברכך השם מציון
וראה בטוב ירושלים
יברכך השם מציון
כל ימי ימי חייך.

וראה בנים לבניך
שלום על ישראל
וראה בנים לבניך
שלום על ישראל.`
        },
        {
            id: 4,
            name: "אל תירא ישראל",
            key: "Am",
            tempo: 110,
            transpose: 7,
            chords: "אין צורך",
            lyrics: `אל תירא ישראל, אל תירא
כי גור אריה הלא אתה
ואריה אם ישאג - מי לא ירא
מי לא יירא.`
        },
        {
            id: 5,
            name: "וטהר ליבנו",
            key: "Am",
            tempo: 110,
            transpose: 0,
            chords: "אין צורך",
            lyrics: `וטהר ליבנו
לעבדך באמת.`
        },
        {
            id: 6,
            name: "השם יתברך תמיד אוהב אותי",
            key: "Am",
            tempo: 145,
            transpose: 7,
            chords: "אין צורך",
            lyrics: `והשם יתברך תמיד אוהב אותי
ותמיד יהיה לי רק טוב
השם יתברך תמיד אוהב אותי ותמיד יהיה לי רק טוב
ויהיה לי עוד יותר טוב
ועוד יותר טוב
ועוד יותר טוב
ועוד יותר טוב
ועוד יותר טוב
ועוד יותר טוב
ותמיד יהיה לי רק טוב.`
        }
    ];

        const mealSongs = [
            {
                id: 1,
                name: "שלום עליכם",
                key: "D",
                tempo: 95,
                transpose: 1,
                chords: "D - A - Bm - G",
                lyrics: "שלום עליכם מלאכי השרת\nמלאכי עליון"
            },
            {
                id: 2,
                name: "אשת חיל",
                key: "F",
                tempo: 80,
                transpose: -2,
                chords: "F - Dm - Bb - C",
                lyrics: "אשת חיל מי ימצא\nורחוק מפנינים מכרה"
            },
            {
                id: 3,
                name: "ברכת המזון",
                key: "A",
                tempo: 105,
                transpose: 4,
                chords: "A - F#m - D - E",
                lyrics: "ברוך אתה ה' אלוהינו מלך העולם\nהזן את העולם כולו"
            },
            {
                id: 4,
                name: "הבדלה",
                key: "Bm",
                tempo: 75,
                transpose: 0,
                chords: "Bm - G - D - A",
                lyrics: "הנה אל ישועתי אבטח ולא אפחד\nכי עזי וזמרת יה ה'"
            }
        ];

        const equipment = [
            { id: 1, item: "מיקרופון אלחוטי", checked: false, category: "קול" },
            { id: 2, item: "מערכת הגברה", checked: false, category: "קול" },
            { id: 3, item: "קלידים", checked: false, category: "כלי נגינה" },
            { id: 4, item: "תופים", checked: false, category: "כלי נגינה" },
            { id: 5, item: "כבלים", checked: false, category: "טכני" },
            { id: 6, item: "מתאם חשמל", checked: false, category: "טכני" },
            { id: 7, item: "עמדת תווים", checked: false, category: "אביזרים" },
            { id: 8, item: "כיסא לקלידן", checked: false, category: "אביזרים" },
            { id: 9, item: "מחשב נייד", checked: false, category: "טכני" },
            { id: 10, item: "רמקולים", checked: false, category: "קול" }
        ];

        const payments = [
            { id: 1, eventName: "דוד כהן", keyboardistPaid: true, drummersPaid: false, receiptIssued: true, managerPaid: true },
            { id: 2, eventName: "יוסי לוי", keyboardistPaid: false, drummersPaid: false, receiptIssued: false, managerPaid: false },
            { id: 3, eventName: "אבי רוזן", keyboardistPaid: true, drummersPaid: true, receiptIssued: false, managerPaid: true }
        ];

        // Calendar data
        const lessons = [
            { id: 1, studentName: "דוד כהן", date: "2024-01-10", time: "16:00", duration: 60, type: "lesson", status: "scheduled" },
            { id: 2, studentName: "אבי רוזן", date: "2024-01-12", time: "17:00", duration: 60, type: "lesson", status: "scheduled" },
            { id: 3, studentName: "דוד כהן", date: "2024-01-15", time: "10:00", duration: 180, type: "event", status: "confirmed" }
        ];

        const blockedDates = [
            { date: "2024-01-20", reason: "חופש" },
            { date: "2024-01-25", reason: "אירוע אישי" }
        ];

        // Communication data
        const messageTemplates = [
            { id: 1, name: "תזכורת לשיעור", content: "שלום {name}, תזכורת לשיעור מחר ב-{time}. נתראה!" },
            { id: 2, name: "תזכורת לאירוע", content: "שלום {parentName}, תזכורת לבר המצווה של {studentName} ב-{date} ב-{time}. בהצלחה!" },
            { id: 3, name: "ביטול שיעור", content: "שלום {name}, צר לי אבל אני צריך לבטל את השיעור של {date}. נתאם תאריך חדש." },
            { id: 4, name: "רשימת שירים", content: "שלום {parentName}, מצורפת רשימת השירים לבר המצווה של {studentName}: {songsList}" }
        ];

        const messageHistory = [
            { id: 1, recipient: "דוד כהן", phone: "050-1234567", message: "שלום דוד, תזכורת לשיעור מחר ב-16:00. נתראה!", sent: "2024-01-09 15:30", status: "sent" },
            { id: 2, recipient: "משה כהן (הורה)", phone: "050-1234567", message: "שלום משה, תזכורת לבר המצווה של דוד ב-15/01 ב-10:00. בהצלחה!", sent: "2024-01-14 09:00", status: "delivered" }
        ];

        // Extended songs library
        const songsLibrary = [
            ...prayerSongs.map(song => ({...song, category: "תפילה"})),
            ...mealSongs.map(song => ({...song, category: "סעודה"})),
            { id: 101, name: "עוד ישמע", key: "Em", tempo: 130, transpose: 0, chords: "Em - C - G - D", lyrics: "עוד ישמע בערי יהודה\nובחוצות ירושלים", category: "חתונה", youtubeLink: "https://youtube.com/watch?v=example1" },
            { id: 102, name: "אם אשכחך", key: "Am", tempo: 85, transpose: 2, chords: "Am - F - C - G", lyrics: "אם אשכחך ירושלים\nתשכח ימיני", category: "מזמורים", youtubeLink: "https://youtube.com/watch?v=example2" },
            { id: 103, name: "הבדלה מלודי", key: "D", tempo: 95, transpose: -1, chords: "D - A - Bm - G", lyrics: "הנה אל ישועתי\nאבטח ולא אפחד", category: "הבדלה", youtubeLink: "https://youtube.com/watch?v=example3" }
        ];

        const playlists = [
            { id: 1, name: "בר מצווה קלאסי", songs: [1, 2, 3, 101], eventType: "בר מצווה", description: "רשימת שירים מסורתית לבר מצווה" },
            { id: 2, name: "שירי שבת", songs: [5, 102, 103], eventType: "שבת", description: "שירים לקבלת שבת ושבת" },
            { id: 3, name: "סעודה חגיגית", songs: [6, 7, 8, 101], eventType: "סעודה", description: "שירים לסעודה חגיגית" }
        ];

        // Unified data structure for Decap CMS
        const systemData = {
            events: events,
            students: students,
            prayerSongs: prayerSongs,
            mealSongs: mealSongs,
            equipment: equipment,
            payments: payments,
            lessons: lessons,
            blockedDates: blockedDates,
            messageTemplates: messageTemplates,
            messageHistory: messageHistory,
            songsLibrary: songsLibrary,
            playlists: playlists,
            lastUpdated: new Date().toISOString()
        };

        let isLoggedIn = false;
        let currentPage = 'events';
        let filteredEvents = [...events];

        // Authentication setup
        let auth0Client;
        let currentAuthProvider = null;

        // Initialize Auth0
        async function initAuth0() {
            try {
                auth0Client = await auth0.createAuth0Client({
                    domain: 'dev-h5dzn2htknam8pcy.us.auth0.com', // Your Auth0 domain
                    clientId: 'dYlfYMFWy7d93bppDhF77uaqqF4IQrTL', // Your Auth0 client ID
                    authorizationParams: {
                        redirect_uri: window.location.origin,
                        scope: 'openid profile email'
                    }
                });
                console.log('Auth0 initialized successfully');
            } catch (error) {
                console.log('Auth0 initialization failed:', error);
                auth0Client = null;
            }
        }



        // DOM Elements
        const loginBtn = document.getElementById('loginBtn');
        const logoutBtn = document.getElementById('logoutBtn');
        const editContentBtn = document.getElementById('editContentBtn');
        const userInfo = document.getElementById('userInfo');
        const loginSection = document.getElementById('loginSection');
        const eventsContainer = document.getElementById('eventsContainer');
        const studentsContainer = document.getElementById('studentsContainer');
        const eventModal = document.getElementById('eventModal');
        const closeModal = document.getElementById('closeModal');
        const modalTitle = document.getElementById('modalTitle');
        const modalContent = document.getElementById('modalContent');
        const menuBtn = document.getElementById('menuBtn');
        const sidebar = document.getElementById('sidebar');
        const closeSidebarBtn = document.getElementById('closeSidebar');
        const overlay = document.getElementById('overlay');

        // Filter elements
        const packageFilter = document.getElementById('packageFilter');
        const keyboardistFilter = document.getElementById('keyboardistFilter');
        const drummersFilter = document.getElementById('drummersFilter');

        // Event Listeners
        loginBtn.addEventListener('click', auth0Login);
        logoutBtn.addEventListener('click', logout);
        editContentBtn.addEventListener('click', openDecapCMS);
        closeModal.addEventListener('click', () => eventModal.classList.add('hidden'));
        menuBtn.addEventListener('click', openSidebar);
        closeSidebarBtn.addEventListener('click', closeSidebar);

        // Filter event listeners
        packageFilter.addEventListener('change', applyFilters);
        keyboardistFilter.addEventListener('change', applyFilters);
        drummersFilter.addEventListener('change', applyFilters);

        // Functions
        function login() {
            isLoggedIn = true;
            loginSection.classList.add('hidden');
            userInfo.classList.remove('hidden');
            
            // Show admin sections
            document.getElementById('adminSection').classList.remove('hidden');
            document.getElementById('equipmentSection').classList.remove('hidden');
            document.getElementById('paymentsSection').classList.remove('hidden');
            
            // Show add event button
            const addEventBtn = document.getElementById('addEventBtn');
            if (addEventBtn) {
                addEventBtn.classList.remove('hidden');
            }
            
            renderCurrentPage();
        }

        async function auth0Login() {
            try {
                if (auth0Client) {
                    console.log('מתחיל התחברות Auth0...');
                    await auth0Client.loginWithRedirect({
                        authorizationParams: {
                            redirect_uri: window.location.origin
                        }
                    });
                    currentAuthProvider = 'auth0';
                } else {
                    console.log('Auth0 לא זמין - מנסה לאתחל מחדש...');
                    await initAuth0();
                    if (auth0Client) {
                        await auth0Client.loginWithRedirect({
                            authorizationParams: {
                                redirect_uri: window.location.origin
                            }
                        });
                        currentAuthProvider = 'auth0';
                    } else {
                        alert('שגיאה: Auth0 לא זמין. אנא בדוק את ההגדרות או נסה שוב מאוחר יותר.');
                    }
                }
            } catch (error) {
                console.error('Auth0 login error:', error);
                alert('שגיאה בהתחברות: ' + error.message);
            }
        }

        function openDecapCMS() {
            // Initialize Decap CMS configuration
            const cmsConfig = {
                backend: {
                    name: 'git-gateway',
                    branch: 'main'
                },
                media_folder: 'static/images',
                public_folder: '/images',
                collections: [
                    {
                        name: 'events',
                        label: 'אירועים',
                        folder: 'content/events',
                        create: true,
                        slug: '{{year}}-{{month}}-{{day}}-{{slug}}',
                        fields: [
                            { label: 'שם בר המצווה', name: 'name', widget: 'string' },
                            { label: 'תאריך', name: 'date', widget: 'datetime' },
                            { label: 'מיקום', name: 'location', widget: 'string' },
                            { label: 'חבילה', name: 'package', widget: 'select', options: ['חבילה בסיסית', 'חבילה חגיגית', 'חבילת הכל כלול'] },
                            { label: 'קלידן', name: 'keyboardist', widget: 'boolean', default: false },
                            { label: 'מספר מתופפים', name: 'drummers', widget: 'number', default: 0 },
                            { label: 'מחיר', name: 'price', widget: 'number' },
                            { label: 'שם ההורה', name: 'parentName', widget: 'string' },
                            { label: 'טלפון', name: 'parentPhone', widget: 'string' },
                            { label: 'הערות', name: 'notes', widget: 'text', required: false }
                        ]
                    },
                    {
                        name: 'prayer-songs',
                        label: 'שירי תפילה',
                        folder: 'content/prayer-songs',
                        create: true,
                        slug: '{{slug}}',
                        fields: [
                            { label: 'שם השיר', name: 'name', widget: 'string' },
                            { label: 'סולם', name: 'key', widget: 'string' },
                            { label: 'קצב (BPM)', name: 'tempo', widget: 'number' },
                            { label: 'טרנספוזיציה', name: 'transpose', widget: 'number', default: 0 },
                            { label: 'אקורדים', name: 'chords', widget: 'string' },
                            { label: 'מילים', name: 'lyrics', widget: 'text' }
                        ]
                    },
                    {
                        name: 'meal-songs',
                        label: 'שירי סעודה',
                        folder: 'content/meal-songs',
                        create: true,
                        slug: '{{slug}}',
                        fields: [
                            { label: 'שם השיר', name: 'name', widget: 'string' },
                            { label: 'סולם', name: 'key', widget: 'string' },
                            { label: 'קצב (BPM)', name: 'tempo', widget: 'number' },
                            { label: 'טרנספוזיציה', name: 'transpose', widget: 'number', default: 0 },
                            { label: 'אקורדים', name: 'chords', widget: 'string' },
                            { label: 'מילים', name: 'lyrics', widget: 'text' }
                        ]
                    }
                ]
            };

            // Initialize and open Decap CMS
            if (window.CMS) {
                window.CMS.init({ config: cmsConfig });
                // Open CMS in a new window/tab
                window.open('/admin/', '_blank');
            } else {
                alert('Decap CMS לא זמין. אנא בדוק את ההגדרות.');
            }
        }

        async function logout() {
            try {
                if (currentAuthProvider === 'auth0' && auth0Client) {
                    await auth0Client.logout({
                        logoutParams: {
                            returnTo: window.location.origin
                        }
                    });
                } else {
                    // Manual logout
                    performLogout();
                }
            } catch (error) {
                console.error('Logout error:', error);
                performLogout();
            }
        }

        function performLogout() {
            isLoggedIn = false;
            loginSection.classList.remove('hidden');
            userInfo.classList.add('hidden');
            currentAuthProvider = null;
            
            // Hide admin sections
            document.getElementById('adminSection').classList.add('hidden');
            document.getElementById('equipmentSection').classList.add('hidden');
            document.getElementById('paymentsSection').classList.add('hidden');
            
            // Hide add event button
            const addEventBtn = document.getElementById('addEventBtn');
            if (addEventBtn) {
                addEventBtn.classList.add('hidden');
            }
            
            renderCurrentPage();
        }

        function openSidebar() {
            sidebar.classList.add('open');
            overlay.classList.remove('hidden');
        }

        function closeSidebar() {
            sidebar.classList.remove('open');
            overlay.classList.add('hidden');
        }

        function showPage(page) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(p => p.classList.add('hidden'));
            
            // Show selected page
            document.getElementById(page + '-page').classList.remove('hidden');
            
            currentPage = page;
            renderCurrentPage();
            closeSidebar();
        }

        function renderCurrentPage() {
            switch(currentPage) {
                case 'events':
                    renderEvents();
                    break;
                case 'prayer-songs':
                    renderPrayerSongs();
                    break;
                case 'meal-songs':
                    renderMealSongs();
                    break;
                case 'admin':
                    if (isLoggedIn) renderStudents();
                    break;
                case 'equipment':
                    if (isLoggedIn) renderEquipment();
                    break;
                case 'payments':
                    if (isLoggedIn) renderPayments();
                    break;
                case 'calendar':
                    if (isLoggedIn) renderCalendar();
                    break;
                case 'communication':
                    if (isLoggedIn) renderCommunication();
                    break;
                case 'songs-library':
                    if (isLoggedIn) renderSongsLibrary();
                    break;
            }
        }

        function applyFilters() {
            const packageValue = packageFilter.value;
            const keyboardistValue = keyboardistFilter.value;
            const drummersValue = drummersFilter.value;

            filteredEvents = events.filter(event => {
                let matches = true;

                if (packageValue && event.package !== packageValue) {
                    matches = false;
                }

                if (keyboardistValue !== '') {
                    const hasKeyboardist = keyboardistValue === 'true';
                    if (event.keyboardist !== hasKeyboardist) {
                        matches = false;
                    }
                }

                if (drummersValue !== '') {
                    const hasDrummers = drummersValue === 'true';
                    if ((event.drummers > 0) !== hasDrummers) {
                        matches = false;
                    }
                }

                return matches;
            });

            renderEvents();
        }

        function renderEvents() {
            eventsContainer.innerHTML = filteredEvents.map((event, index) => {
                const eventDate = new Date(event.date);
                const formattedDate = eventDate.toLocaleDateString('he-IL', {
                    day: 'numeric',
                    month: 'long',
                    year: 'numeric'
                });

                const statusColors = {
                    'confirmed': 'bg-green-500',
                    'pending': 'bg-yellow-500'
                };

                const gradientClass = `card-gradient-${(index % 6) + 1}`;

                return `
                    <div class="bg-white border border-gray-200 rounded-3xl shadow-lg hover:shadow-xl transition-all duration-300 cursor-pointer overflow-hidden" onclick="openEventModal(${event.id})">
                        <!-- Gradient Header -->
                        <div class="${gradientClass} p-4 text-white">
                            <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
                                <div class="flex items-center mb-2 sm:mb-0">
                                    <span class="status-indicator ${statusColors[event.status]} ml-3 bg-white bg-opacity-80"></span>
                                    <h3 class="text-lg sm:text-xl font-bold">בר מצווה - ${event.name}</h3>
                                </div>
                                ${event.isStudent ? '<span class="bg-white bg-opacity-20 text-white px-3 py-1 rounded-full text-xs font-medium self-start sm:self-center">תלמיד פרטי</span>' : ''}
                            </div>
                        </div>

                        <!-- Content -->
                        <div class="p-4 sm:p-5">
                            <div class="flex flex-col lg:flex-row lg:justify-between lg:items-center">
                                <div class="flex-1 mb-4 lg:mb-0">
                                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3 text-gray-600">
                                        <div class="bg-blue-50 p-3 rounded-2xl border border-blue-200 cursor-pointer hover:bg-blue-100 transition-colors" onclick="event.stopPropagation(); addToGoogleCalendar(${event.id})">
                                            <div class="flex items-center">
                                                <span class="text-blue-600 ml-2 text-lg">📅</span>
                                                <div class="flex flex-col">
                                                    <span class="text-xs text-blue-600 font-medium">תאריך</span>
                                                    <span class="font-bold text-blue-800 text-sm">${formattedDate}</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="bg-green-50 p-3 rounded-2xl border border-green-200">
                                            <div class="flex items-center">
                                                <span class="text-green-600 ml-2 text-lg">👥</span>
                                                <div class="flex flex-col">
                                                    <span class="text-xs text-green-600 font-medium">הגעת אורחים</span>
                                                    <span class="font-bold text-green-800 text-sm">${event.guestArrivalTime || event.time}</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="bg-orange-50 p-3 rounded-2xl border border-orange-200">
                                            <div class="flex items-center">
                                                <span class="text-orange-600 ml-2 text-lg">🎉</span>
                                                <div class="flex flex-col">
                                                    <span class="text-xs text-orange-600 font-medium">תחילת אירוע</span>
                                                    <span class="font-bold text-orange-800 text-sm">${event.eventStartTime || event.time}</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="bg-purple-50 p-3 rounded-2xl border border-purple-200 cursor-pointer hover:bg-purple-100 transition-colors" onclick="event.stopPropagation(); openWaze('${event.wazeLink}')">
                                            <div class="flex items-center">
                                                <span class="text-purple-600 ml-2 text-lg">📍</span>
                                                <div class="flex flex-col flex-1">
                                                    <span class="text-xs text-purple-600 font-medium">מיקום</span>
                                                    <span class="font-bold text-purple-800 text-sm text-right truncate">
                                                        ${event.location}
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="flex flex-col sm:flex-row items-start sm:items-center space-y-2 sm:space-y-0 sm:space-x-3 sm:space-x-reverse">
                                    ${isLoggedIn ? `
                                        <div class="flex space-x-2 space-x-reverse">
                                            <button onclick="event.stopPropagation(); editEvent(${event.id})" class="bg-blue-600 text-white px-3 py-2 rounded-2xl text-sm hover:bg-blue-700 transition-colors font-medium">
                                                ערוך
                                            </button>
                                            <button onclick="event.stopPropagation(); deleteEvent(${event.id})" class="bg-red-600 text-white px-3 py-2 rounded-2xl text-sm hover:bg-red-700 transition-colors font-medium">
                                                מחק
                                            </button>
                                        </div>
                                    ` : ''}
                                    <div class="flex items-center text-blue-600 hover:text-blue-800 font-medium text-sm bg-blue-50 px-3 py-2 rounded-2xl hover:bg-blue-100 transition-colors">
                                        <span>פרטים נוספים</span>
                                        <span class="mr-2">←</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function renderPrayerSongs() {
            const container = document.getElementById('prayerSongsContainer');
            container.innerHTML = prayerSongs.map(song => `
                <div class="song-card p-6 rounded-3xl shadow-sm hover:shadow-md transition-all">
                    <div class="flex justify-between items-start mb-4">
                        <h3 class="text-xl font-bold text-gray-800">${song.name}</h3>
                        <div class="flex space-x-2 space-x-reverse">
                            <span class="bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-sm font-medium">${song.key}</span>
                            <span class="bg-green-100 text-green-700 px-3 py-1 rounded-full text-sm font-medium">${song.tempo} BPM</span>
                            ${song.transpose !== 0 ? `<span class="bg-purple-100 text-purple-700 px-3 py-1 rounded-full text-sm font-medium">${song.transpose > 0 ? '+' : ''}${song.transpose}</span>` : ''}
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <h4 class="font-semibold text-gray-700 mb-2">אקורדים:</h4>
                            <p class="text-gray-600 bg-gray-50 p-3 rounded-2xl font-mono">${song.chords}</p>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-700 mb-2">מילים:</h4>
                            <p class="text-gray-600 bg-gray-50 p-3 rounded-2xl whitespace-pre-line">${song.lyrics}</p>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function renderMealSongs() {
            const container = document.getElementById('mealSongsContainer');
            container.innerHTML = mealSongs.map(song => `
                <div class="song-card p-6 rounded-3xl shadow-sm hover:shadow-md transition-all">
                    <div class="flex justify-between items-start mb-4">
                        <h3 class="text-xl font-bold text-gray-800">${song.name}</h3>
                        <div class="flex space-x-2 space-x-reverse">
                            <span class="bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-sm font-medium">${song.key}</span>
                            <span class="bg-green-100 text-green-700 px-3 py-1 rounded-full text-sm font-medium">${song.tempo} BPM</span>
                            ${song.transpose !== 0 ? `<span class="bg-purple-100 text-purple-700 px-3 py-1 rounded-full text-sm font-medium">${song.transpose > 0 ? '+' : ''}${song.transpose}</span>` : ''}
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <h4 class="font-semibold text-gray-700 mb-2">אקורדים:</h4>
                            <p class="text-gray-600 bg-gray-50 p-3 rounded-2xl font-mono">${song.chords}</p>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-700 mb-2">מילים:</h4>
                            <p class="text-gray-600 bg-gray-50 p-3 rounded-2xl whitespace-pre-line">${song.lyrics}</p>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function renderStudents() {
            if (!isLoggedIn) return;
            
            studentsContainer.innerHTML = students.map(student => {
                const progressPercentage = (student.lessonsCompleted / student.totalLessons) * 100;
                
                return `
                    <div class="p-6 hover:bg-gray-50 transition-colors border-b border-gray-100 last:border-b-0">
                        <div class="flex flex-col lg:flex-row lg:justify-between lg:items-start gap-6">
                            <!-- Basic Info -->
                            <div class="flex-1">
                                <div class="flex items-center justify-between mb-4">
                                    <h3 class="text-xl font-bold text-gray-800">${student.name}</h3>
                                    <span class="px-3 py-1 rounded-full text-sm font-medium ${student.hasRecording ? 'bg-green-100 text-green-700' : 'bg-orange-100 text-orange-700'}">
                                        ${student.hasRecording ? '🎤 יש הקלטה' : '⏳ ללא הקלטה'}
                                    </span>
                                </div>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                    <div class="bg-blue-50 p-3 rounded-2xl border border-blue-200">
                                        <div class="text-sm text-blue-600 font-medium mb-1">תאריכים חשובים</div>
                                        <div class="text-blue-800">
                                            <div><span class="font-medium">בר מצווה:</span> ${new Date(student.eventDate).toLocaleDateString('he-IL')}</div>
                                            <div><span class="font-medium">שיעור הבא:</span> ${new Date(student.nextLesson).toLocaleDateString('he-IL')}</div>
                                        </div>
                                    </div>
                                    
                                    <div class="bg-purple-50 p-3 rounded-2xl border border-purple-200">
                                        <div class="text-sm text-purple-600 font-medium mb-1">פרטי קריאה</div>
                                        <div class="text-purple-800">
                                            <div><span class="font-medium">פרשה:</span> ${student.parsha}</div>
                                            <div><span class="font-medium">סוג קריאה:</span> ${student.readingType}</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Torah Reading Details -->
                                <div class="bg-gradient-to-l from-amber-50 to-yellow-50 p-4 rounded-2xl border border-amber-200 mb-4">
                                    <h4 class="text-amber-800 font-semibold mb-3 flex items-center">
                                        <span class="ml-2">📜</span>
                                        פרטי קריאה בתורה
                                    </h4>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-sm">
                                        <div>
                                            <span class="font-medium text-amber-700">קטע בתורה:</span>
                                            <div class="text-amber-800 bg-amber-100 p-2 rounded-lg mt-1">${student.torahPortion}</div>
                                        </div>
                                        <div>
                                            <span class="font-medium text-amber-700">הפטרה:</span>
                                            <div class="text-amber-800 bg-amber-100 p-2 rounded-lg mt-1">${student.haftarah}</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Progress Bar -->
                                <div class="mb-4">
                                    <div class="flex justify-between items-center mb-2">
                                        <span class="text-sm font-medium text-gray-700">התקדמות בלימודים</span>
                                        <span class="text-sm text-gray-600">${student.lessonsCompleted}/${student.totalLessons} שיעורים</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-3">
                                        <div class="bg-gradient-to-r from-blue-500 to-blue-600 h-3 rounded-full transition-all duration-300" style="width: ${progressPercentage}%"></div>
                                    </div>
                                    <div class="text-xs text-gray-500 mt-1">${Math.round(progressPercentage)}% הושלם</div>
                                </div>
                                
                                <!-- Progress Notes -->
                                <div class="bg-gray-50 p-4 rounded-2xl mb-4">
                                    <h4 class="font-semibold text-gray-700 mb-2">התקדמות כללית:</h4>
                                    <p class="text-gray-700 text-sm">${student.progress}</p>
                                </div>
                                
                                <!-- Special Notes -->
                                <div class="bg-indigo-50 p-4 rounded-2xl border border-indigo-200">
                                    <h4 class="font-semibold text-indigo-700 mb-2">הערות מיוחדות:</h4>
                                    <p class="text-indigo-800 text-sm">${student.specialNotes}</p>
                                </div>
                            </div>
                            
                            <!-- Recording Section -->
                            <div class="lg:w-80">
                                <div class="bg-white border border-gray-200 rounded-2xl p-4 shadow-sm">
                                    <h4 class="font-semibold text-gray-800 mb-3 flex items-center">
                                        <span class="ml-2">🎤</span>
                                        מצב הקלטה
                                    </h4>
                                    
                                    <div class="space-y-3">
                                        <div class="flex items-center justify-between p-3 rounded-xl ${student.hasRecording ? 'bg-green-50 border border-green-200' : 'bg-orange-50 border border-orange-200'}">
                                            <span class="font-medium ${student.hasRecording ? 'text-green-700' : 'text-orange-700'}">
                                                ${student.hasRecording ? 'הקלטה קיימת' : 'ללא הקלטה'}
                                            </span>
                                            <span class="text-2xl">${student.hasRecording ? '✅' : '❌'}</span>
                                        </div>
                                        
                                        <div class="bg-gray-50 p-3 rounded-xl">
                                            <div class="text-sm text-gray-600 font-medium mb-1">הערות הקלטה:</div>
                                            <div class="text-gray-700 text-sm">${student.recordingNotes}</div>
                                        </div>
                                        
                                        <div class="flex flex-col space-y-2">
                                            <button onclick="toggleRecording(${student.id})" class="w-full px-4 py-2 rounded-xl text-sm font-medium transition-colors ${student.hasRecording ? 'bg-orange-600 text-white hover:bg-orange-700' : 'bg-green-600 text-white hover:bg-green-700'}">
                                                ${student.hasRecording ? '🗑️ מחק הקלטה' : '🎤 הוסף הקלטה'}
                                            </button>
                                            
                                            <button onclick="editStudent(${student.id})" class="w-full bg-blue-600 text-white px-4 py-2 rounded-xl hover:bg-blue-700 transition-colors text-sm font-medium">
                                                ✏️ ערוך פרטים
                                            </button>
                                            
                                            <button onclick="viewStudentProgress(${student.id})" class="w-full bg-purple-600 text-white px-4 py-2 rounded-xl hover:bg-purple-700 transition-colors text-sm font-medium">
                                                📊 יומן שיעורים
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function renderEquipment() {
            const container = document.getElementById('equipmentContainer');
            const categories = [...new Set(equipment.map(item => item.category))];
            
            container.innerHTML = categories.map(category => {
                const categoryItems = equipment.filter(item => item.category === category);
                return `
                    <div class="mb-8">
                        <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center">
                            <span class="w-3 h-3 bg-blue-500 rounded-full ml-2"></span>
                            ${category}
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                            ${categoryItems.map(item => `
                                <div class="flex items-center p-4 bg-gray-50 rounded-2xl hover:bg-gray-100 transition-colors">
                                    <input type="checkbox" id="equipment-${item.id}" ${item.checked ? 'checked' : ''} 
                                           onchange="toggleEquipment(${item.id})"
                                           class="w-5 h-5 text-blue-600 rounded-lg focus:ring-blue-500 ml-3">
                                    <label for="equipment-${item.id}" class="flex-1 font-medium text-gray-700 cursor-pointer">
                                        ${item.item}
                                    </label>
                                    <span class="text-2xl">${item.checked ? '✅' : '⭕'}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function renderPayments() {
            const container = document.getElementById('paymentsContainer');
            container.innerHTML = payments.map(payment => `
                <div class="bg-gray-50 p-6 rounded-3xl mb-4 hover:bg-gray-100 transition-colors">
                    <h3 class="text-lg font-bold text-gray-800 mb-4">אירוע: ${payment.eventName}</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                        <div class="flex items-center justify-between p-4 bg-white rounded-2xl">
                            <span class="font-medium text-gray-700">תשלום לקלידן</span>
                            <div class="flex items-center">
                                <span class="text-2xl ml-2">${payment.keyboardistPaid ? '✅' : '❌'}</span>
                                <button onclick="togglePayment(${payment.id}, 'keyboardist')" 
                                        class="px-3 py-1 rounded-full text-sm font-medium transition-colors ${payment.keyboardistPaid ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'}">
                                    ${payment.keyboardistPaid ? 'שולם' : 'לא שולם'}
                                </button>
                            </div>
                        </div>
                        <div class="flex items-center justify-between p-4 bg-white rounded-2xl">
                            <span class="font-medium text-gray-700">תשלום למתופפים</span>
                            <div class="flex items-center">
                                <span class="text-2xl ml-2">${payment.drummersPaid ? '✅' : '❌'}</span>
                                <button onclick="togglePayment(${payment.id}, 'drummers')" 
                                        class="px-3 py-1 rounded-full text-sm font-medium transition-colors ${payment.drummersPaid ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'}">
                                    ${payment.drummersPaid ? 'שולם' : 'לא שולם'}
                                </button>
                            </div>
                        </div>
                        <div class="flex items-center justify-between p-4 bg-white rounded-2xl">
                            <span class="font-medium text-gray-700">תשלום למנהלת</span>
                            <div class="flex items-center">
                                <span class="text-2xl ml-2">${payment.managerPaid ? '✅' : '❌'}</span>
                                <button onclick="togglePayment(${payment.id}, 'manager')" 
                                        class="px-3 py-1 rounded-full text-sm font-medium transition-colors ${payment.managerPaid ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'}">
                                    ${payment.managerPaid ? 'שולם' : 'לא שולם'}
                                </button>
                            </div>
                        </div>
                        <div class="flex items-center justify-between p-4 bg-white rounded-2xl">
                            <span class="font-medium text-gray-700">קבלה הוצאה</span>
                            <div class="flex items-center">
                                <span class="text-2xl ml-2">${payment.receiptIssued ? '✅' : '❌'}</span>
                                <button onclick="togglePayment(${payment.id}, 'receipt')" 
                                        class="px-3 py-1 rounded-full text-sm font-medium transition-colors ${payment.receiptIssued ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'}">
                                    ${payment.receiptIssued ? 'הוצאה' : 'לא הוצאה'}
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function toggleEquipment(id) {
            const item = equipment.find(e => e.id === id);
            if (item) {
                item.checked = !item.checked;
                renderEquipment();
            }
        }

        function togglePayment(id, type) {
            const payment = payments.find(p => p.id === id);
            if (payment) {
                switch(type) {
                    case 'keyboardist':
                        payment.keyboardistPaid = !payment.keyboardistPaid;
                        break;
                    case 'drummers':
                        payment.drummersPaid = !payment.drummersPaid;
                        break;
                    case 'manager':
                        payment.managerPaid = !payment.managerPaid;
                        break;
                    case 'receipt':
                        payment.receiptIssued = !payment.receiptIssued;
                        break;
                }
                renderPayments();
            }
        }

        function openEventModal(eventId) {
            const event = events.find(e => e.id === eventId);
            if (!event) return;

            modalTitle.textContent = `בר מצווה - ${event.name}`;
            
            const packageColors = {
                'חבילה בסיסית': 'bg-blue-50 text-blue-700 border-blue-200',
                'חבילה חגיגית': 'bg-purple-50 text-purple-700 border-purple-200',
                'חבילת הכל כלול': 'bg-amber-50 text-amber-700 border-amber-200'
            };

            const musicians = [];
            if (event.keyboardist) musicians.push('קלידן');
            if (event.drummers > 0) musicians.push(`${event.drummers} מתופפים`);
            const musicianText = musicians.length > 0 ? musicians.join(' + ') : 'ללא ליווי מוזיקלי';

            let modalHTML = `
                <div class="space-y-4 sm:space-y-6">
                    <!-- Basic Event Info -->
                    <div class="bg-gradient-to-l from-blue-50 to-indigo-50 p-4 sm:p-6 rounded-2xl sm:rounded-3xl border border-blue-100">
                        <h4 class="text-base sm:text-lg font-semibold text-gray-800 mb-3 sm:mb-4">פרטי האירוע</h4>
                        <div class="space-y-3 sm:space-y-0 sm:grid sm:grid-cols-1 md:grid-cols-3 sm:gap-4">
                            <div class="bg-blue-100 p-3 rounded-xl border border-blue-200 cursor-pointer hover:bg-blue-200 transition-colors" onclick="addToGoogleCalendar(${event.id})">
                                <div class="flex items-center">
                                    <span class="text-blue-600 ml-2 text-lg">📅</span>
                                    <div>
                                        <span class="font-medium text-blue-800 text-sm">תאריך:</span>
                                        <div class="text-blue-700 font-bold text-sm">${new Date(event.date).toLocaleDateString('he-IL', { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' })}</div>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-green-100 p-3 rounded-xl border border-green-200">
                                <div class="flex items-center">
                                    <span class="text-green-600 ml-2 text-lg">👥</span>
                                    <div>
                                        <span class="font-medium text-green-800 text-sm">הגעת אורחים:</span>
                                        <div class="text-green-700 font-bold text-sm">${event.guestArrivalTime || event.time}</div>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-orange-100 p-3 rounded-xl border border-orange-200">
                                <div class="flex items-center">
                                    <span class="text-orange-600 ml-2 text-lg">🎉</span>
                                    <div>
                                        <span class="font-medium text-orange-800 text-sm">תחילת אירוע:</span>
                                        <div class="text-orange-700 font-bold text-sm">${event.eventStartTime || event.time}</div>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-purple-100 p-3 rounded-xl border border-purple-200 md:col-span-3 cursor-pointer hover:bg-purple-200 transition-colors" onclick="openWaze('${event.wazeLink}')">
                                <div class="flex items-center">
                                    <span class="text-purple-600 ml-2 text-lg">📍</span>
                                    <div class="flex-1">
                                        <span class="font-medium text-purple-800 text-sm">מיקום:</span>
                                        <div class="flex items-center justify-between">
                                            <div class="text-purple-700 font-bold text-sm flex-1">${event.location}</div>
                                            ${isLoggedIn ? `
                                                <button onclick="event.stopPropagation(); editWazeLink(${event.id})" 
                                                        class="bg-orange-600 text-white px-2 py-1 rounded-lg text-xs hover:bg-orange-700 transition-colors">
                                                    ⚙️
                                                </button>
                                            ` : ''}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Package and Music -->
                    <div class="grid grid-cols-1 gap-4 sm:gap-6">
                        <div>
                            <h4 class="text-base sm:text-lg font-semibold text-gray-800 mb-2 sm:mb-3">חבילת השירות</h4>
                            <div class="inline-block px-3 sm:px-4 py-2 sm:py-3 rounded-xl sm:rounded-2xl border ${packageColors[event.package]} font-medium text-sm sm:text-base">
                                ${event.package}
                            </div>
                        </div>
                        
                        <div>
                            <h4 class="text-base sm:text-lg font-semibold text-gray-800 mb-2 sm:mb-3">ליווי מוזיקלי</h4>
                            <div class="bg-gray-50 p-3 sm:p-4 rounded-xl sm:rounded-2xl">
                                <div class="flex items-center">
                                    <span class="text-orange-500 ml-2">🎵</span>
                                    <span class="text-gray-700 text-sm sm:text-base">${musicianText}</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    ${isLoggedIn ? `
                        <!-- Admin Only Details -->
                        <div class="border-t border-gray-200 pt-4 sm:pt-6">
                            <div class="grid grid-cols-1 gap-4 sm:gap-6">
                                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                    <div>
                                        <h4 class="text-base sm:text-lg font-semibold text-gray-800 mb-2 sm:mb-3">פרטים פיננסיים</h4>
                                        <div class="bg-green-50 p-3 sm:p-4 rounded-xl sm:rounded-2xl border border-green-200">
                                            <div class="text-xl sm:text-2xl font-bold text-green-600">₪${event.price.toLocaleString()}</div>
                                            <div class="text-xs sm:text-sm text-gray-600">מחיר סופי</div>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <h4 class="text-base sm:text-lg font-semibold text-gray-800 mb-2 sm:mb-3">פרטי קשר</h4>
                                        <div class="bg-gray-50 p-3 sm:p-4 rounded-xl sm:rounded-2xl space-y-2">
                                            <div class="text-sm"><span class="font-medium">הורה:</span> ${event.parentName}</div>
                                            <div class="text-sm"><span class="font-medium">טלפון:</span> ${event.parentPhone}</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div>
                                    <h4 class="text-base sm:text-lg font-semibold text-gray-800 mb-2 sm:mb-3">הערות</h4>
                                    <div class="bg-yellow-50 p-3 sm:p-4 rounded-xl sm:rounded-2xl border border-yellow-200">
                                        <p class="text-gray-700 text-sm sm:text-base">${event.notes}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    ` : ''}
                </div>
                
                <div class="flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-3 sm:space-x-reverse mt-6 sm:mt-8 pt-4 sm:pt-6 border-t border-gray-200">
                    <button class="px-4 sm:px-6 py-2 bg-gray-200 text-gray-700 rounded-xl sm:rounded-2xl hover:bg-gray-300 transition-colors font-medium text-sm sm:text-base" onclick="document.getElementById('eventModal').classList.add('hidden')">
                        סגור
                    </button>
                    ${isLoggedIn ? `<button onclick="editEvent(${event.id})" class="px-4 sm:px-6 py-2 bg-blue-600 text-white rounded-xl sm:rounded-2xl hover:bg-blue-700 transition-colors font-medium text-sm sm:text-base">ערוך פרטים</button>` : ''}
                </div>
            `;

            modalContent.innerHTML = modalHTML;
            eventModal.classList.remove('hidden');
        }

        // Waze and Google Calendar Functions
        function openWaze(wazeLink) {
            if (wazeLink) {
                window.open(wazeLink, '_blank');
            } else {
                alert('קישור Waze לא זמין לאירוע זה');
            }
        }

        function addToGoogleCalendar(eventId) {
            const event = events.find(e => e.id === eventId);
            if (!event) return;

            // Create event date and time (using event start time)
            const eventDate = new Date(event.date);
            const [hours, minutes] = event.eventStartTime.split(':');
            eventDate.setHours(parseInt(hours), parseInt(minutes));
            
            // End time (assuming 3 hours duration for bar mitzvah)
            const endDate = new Date(eventDate);
            endDate.setHours(endDate.getHours() + 3);

            // Format dates for Google Calendar (YYYYMMDDTHHMMSSZ)
            const startTime = eventDate.toISOString().replace(/[-:]/g, '').replace(/\.\d{3}/, '');
            const endTime = endDate.toISOString().replace(/[-:]/g, '').replace(/\.\d{3}/, '');

            // Create event details
            const title = `בר מצווה - ${event.name}`;
            const details = `
בר מצווה: ${event.name}
חבילה: ${event.package}
מיקום: ${event.location}

⏰ זמנים:
👥 הגעת אורחים: ${event.guestArrivalTime}
🎉 תחילת אירוע: ${event.eventStartTime}

${event.keyboardist ? '🎹 עם קלידן' : ''}
${event.drummers > 0 ? `🥁 ${event.drummers} מתופפים` : ''}
${event.notes ? `\nהערות: ${event.notes}` : ''}
${isLoggedIn ? `\nהורה: ${event.parentName}\nטלפון: ${event.parentPhone}\nמחיר: ₪${event.price.toLocaleString()}` : ''}
            `.trim();

            // Create Google Calendar URL
            const googleCalendarUrl = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(title)}&dates=${startTime}/${endTime}&details=${encodeURIComponent(details)}&location=${encodeURIComponent(event.location)}&sf=true&output=xml`;

            // Open Google Calendar
            window.open(googleCalendarUrl, '_blank');
        }

        function editWazeLink(eventId) {
            const event = events.find(e => e.id === eventId);
            if (event) {
                const newLink = prompt('הכנס קישור Waze חדש:', event.wazeLink);
                if (newLink !== null) {
                    event.wazeLink = newLink;
                    // Re-render the modal
                    openEventModal(eventId);
                    alert('קישור Waze עודכן בהצלחה!');
                }
            }
        }

        function editEvent(eventId) {
            alert(`עריכת אירוע ${eventId} - פונקציה זו תפותח בהמשך`);
        }

        function deleteEvent(eventId) {
            if (confirm('האם אתה בטוח שברצונך למחוק את האירוע?')) {
                const eventIndex = events.findIndex(e => e.id === eventId);
                if (eventIndex > -1) {
                    events.splice(eventIndex, 1);
                    // Update filtered events as well
                    const filteredIndex = filteredEvents.findIndex(e => e.id === eventId);
                    if (filteredIndex > -1) {
                        filteredEvents.splice(filteredIndex, 1);
                    }
                    renderEvents();
                }
            }
        }

        // Calendar functions
        function renderCalendar() {
            const container = document.getElementById('calendarContainer');
            const today = new Date();
            const currentMonth = today.getMonth();
            const currentYear = today.getFullYear();
            
            // Get lessons for current month
            const monthLessons = lessons.filter(lesson => {
                const lessonDate = new Date(lesson.date);
                return lessonDate.getMonth() === currentMonth && lessonDate.getFullYear() === currentYear;
            });

            container.innerHTML = `
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="lg:col-span-2">
                        <h3 class="text-lg font-bold text-gray-800 mb-4">שיעורים השבוע</h3>
                        <div class="space-y-3">
                            ${monthLessons.map(lesson => `
                                <div class="bg-gradient-to-l from-blue-50 to-indigo-50 p-4 rounded-2xl border border-blue-200">
                                    <div class="flex justify-between items-center">
                                        <div>
                                            <h4 class="font-semibold text-gray-800">${lesson.studentName}</h4>
                                            <div class="text-sm text-gray-600">
                                                ${new Date(lesson.date).toLocaleDateString('he-IL')} • ${lesson.time} • ${lesson.duration} דקות
                                            </div>
                                            <span class="inline-block px-2 py-1 rounded-full text-xs font-medium mt-2 ${
                                                lesson.type === 'lesson' ? 'bg-blue-100 text-blue-700' : 'bg-purple-100 text-purple-700'
                                            }">
                                                ${lesson.type === 'lesson' ? 'שיעור' : 'אירוע'}
                                            </span>
                                        </div>
                                        <div class="flex space-x-2 space-x-reverse">
                                            <button onclick="editLesson(${lesson.id})" class="bg-blue-600 text-white px-3 py-1 rounded-xl text-sm hover:bg-blue-700">
                                                ערוך
                                            </button>
                                            <button onclick="sendReminder(${lesson.id})" class="bg-green-600 text-white px-3 py-1 rounded-xl text-sm hover:bg-green-700">
                                                תזכורת
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div>
                        <h3 class="text-lg font-bold text-gray-800 mb-4">תאריכים חסומים</h3>
                        <div class="space-y-2">
                            ${blockedDates.map(blocked => `
                                <div class="bg-red-50 p-3 rounded-2xl border border-red-200">
                                    <div class="font-medium text-red-800">${new Date(blocked.date).toLocaleDateString('he-IL')}</div>
                                    <div class="text-sm text-red-600">${blocked.reason}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        // Communication functions
        function renderCommunication() {
            const templatesContainer = document.getElementById('messageTemplates');
            const historyContainer = document.getElementById('messageHistory');

            templatesContainer.innerHTML = `
                <div class="bg-white rounded-2xl border border-gray-200 p-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-4">תבניות הודעות</h3>
                    <div class="space-y-3">
                        ${messageTemplates.map(template => `
                            <div class="bg-gray-50 p-4 rounded-2xl">
                                <div class="flex justify-between items-start mb-2">
                                    <h4 class="font-semibold text-gray-800">${template.name}</h4>
                                    <button onclick="useTemplate(${template.id})" class="bg-blue-600 text-white px-3 py-1 rounded-xl text-sm hover:bg-blue-700">
                                        השתמש
                                    </button>
                                </div>
                                <p class="text-gray-600 text-sm">${template.content}</p>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div class="mt-6 p-4 bg-blue-50 rounded-2xl border border-blue-200">
                        <h4 class="font-semibold text-blue-800 mb-3">שלח הודעה חדשה</h4>
                        <div class="space-y-3">
                            <select id="recipientSelect" class="w-full border border-gray-300 rounded-xl px-3 py-2">
                                <option value="">בחר נמען</option>
                                ${students.map(student => `
                                    <option value="${student.phone}">${student.name}</option>
                                `).join('')}
                                ${events.map(event => `
                                    <option value="${event.parentPhone}">${event.parentName} (הורה של ${event.name})</option>
                                `).join('')}
                            </select>
                            <textarea id="messageContent" placeholder="תוכן ההודעה..." class="w-full border border-gray-300 rounded-xl px-3 py-2 h-24 resize-none"></textarea>
                            <button onclick="sendWhatsAppMessage()" class="w-full bg-green-600 text-white py-2 rounded-xl hover:bg-green-700 font-medium">
                                📱 שלח ב-WhatsApp
                            </button>
                        </div>
                    </div>
                </div>
            `;

            historyContainer.innerHTML = `
                <div class="bg-white rounded-2xl border border-gray-200 p-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-4">היסטוריית הודעות</h3>
                    <div class="space-y-3 max-h-96 overflow-y-auto">
                        ${messageHistory.map(msg => `
                            <div class="bg-gray-50 p-4 rounded-2xl">
                                <div class="flex justify-between items-start mb-2">
                                    <div>
                                        <h4 class="font-semibold text-gray-800">${msg.recipient}</h4>
                                        <div class="text-sm text-gray-600">${msg.phone}</div>
                                    </div>
                                    <div class="text-left">
                                        <div class="text-xs text-gray-500">${new Date(msg.sent).toLocaleString('he-IL')}</div>
                                        <span class="inline-block px-2 py-1 rounded-full text-xs font-medium mt-1 ${
                                            msg.status === 'delivered' ? 'bg-green-100 text-green-700' : 'bg-blue-100 text-blue-700'
                                        }">
                                            ${msg.status === 'delivered' ? 'נמסר' : 'נשלח'}
                                        </span>
                                    </div>
                                </div>
                                <p class="text-gray-700 text-sm">${msg.message}</p>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // Songs Library functions
        function renderSongsLibrary() {
            const libraryContainer = document.getElementById('songsLibraryContainer');
            const playlistsContainer = document.getElementById('playlistsContainer');

            // Filter songs based on search
            const searchTerm = document.getElementById('songSearch')?.value.toLowerCase() || '';
            const filteredSongs = songsLibrary.filter(song => 
                song.name.toLowerCase().includes(searchTerm) ||
                song.category.toLowerCase().includes(searchTerm) ||
                song.lyrics.toLowerCase().includes(searchTerm)
            );

            libraryContainer.innerHTML = `
                <div class="space-y-4">
                    <div class="flex justify-between items-center">
                        <h3 class="text-lg font-bold text-gray-800">כל השירים (${filteredSongs.length})</h3>
                        <div class="flex space-x-2 space-x-reverse">
                            <select id="categoryFilter" onchange="filterByCategory()" class="border border-gray-300 rounded-xl px-3 py-2 text-sm">
                                <option value="">כל הקטגוריות</option>
                                <option value="תפילה">תפילה</option>
                                <option value="סעודה">סעודה</option>
                                <option value="חתונה">חתונה</option>
                                <option value="מזמורים">מזמורים</option>
                                <option value="הבדלה">הבדלה</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 gap-4">
                        ${filteredSongs.map(song => `
                            <div class="song-card p-4 rounded-2xl shadow-sm hover:shadow-md transition-all">
                                <div class="flex justify-between items-start mb-3">
                                    <div>
                                        <h4 class="text-lg font-bold text-gray-800">${song.name}</h4>
                                        <div class="flex items-center space-x-2 space-x-reverse mt-1">
                                            <span class="bg-purple-100 text-purple-700 px-2 py-1 rounded-full text-xs font-medium">${song.category}</span>
                                            <span class="bg-blue-100 text-blue-700 px-2 py-1 rounded-full text-xs font-medium">${song.key}</span>
                                            <span class="bg-green-100 text-green-700 px-2 py-1 rounded-full text-xs font-medium">${song.tempo} BPM</span>
                                        </div>
                                    </div>
                                    <div class="flex space-x-2 space-x-reverse">
                                        ${song.youtubeLink ? `
                                            <button onclick="window.open('${song.youtubeLink}', '_blank')" class="bg-red-600 text-white px-3 py-1 rounded-xl text-sm hover:bg-red-700">
                                                📺 YouTube
                                            </button>
                                        ` : ''}
                                        <button onclick="addToPlaylist(${song.id})" class="bg-green-600 text-white px-3 py-1 rounded-xl text-sm hover:bg-green-700">
                                            ➕ לרשימה
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-sm">
                                    <div>
                                        <span class="font-medium text-gray-700">אקורדים:</span>
                                        <div class="bg-gray-100 p-2 rounded-lg font-mono mt-1">${song.chords}</div>
                                    </div>
                                    <div>
                                        <span class="font-medium text-gray-700">מילים:</span>
                                        <div class="bg-gray-100 p-2 rounded-lg mt-1 max-h-20 overflow-y-auto">${song.lyrics}</div>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;

            playlistsContainer.innerHTML = `
                <div class="bg-white rounded-2xl border border-gray-200 p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-bold text-gray-800">רשימות שירים</h3>
                        <button onclick="createPlaylist()" class="bg-blue-600 text-white px-3 py-2 rounded-xl text-sm hover:bg-blue-700">
                            ➕ רשימה חדשה
                        </button>
                    </div>
                    
                    <div class="space-y-3">
                        ${playlists.map(playlist => `
                            <div class="bg-gradient-to-l from-blue-50 to-indigo-50 p-4 rounded-2xl border border-blue-200">
                                <div class="flex justify-between items-start mb-2">
                                    <div>
                                        <h4 class="font-semibold text-gray-800">${playlist.name}</h4>
                                        <div class="text-sm text-gray-600">${playlist.songs.length} שירים • ${playlist.eventType}</div>
                                    </div>
                                    <button onclick="viewPlaylist(${playlist.id})" class="bg-blue-600 text-white px-3 py-1 rounded-xl text-sm hover:bg-blue-700">
                                        צפה
                                    </button>
                                </div>
                                <p class="text-gray-700 text-sm">${playlist.description}</p>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // WhatsApp integration
        function sendWhatsAppMessage() {
            const recipient = document.getElementById('recipientSelect').value;
            const message = document.getElementById('messageContent').value;
            
            if (!recipient || !message) {
                alert('אנא בחר נמען והכנס הודעה');
                return;
            }

            // Create WhatsApp URL
            const whatsappUrl = `https://wa.me/${recipient.replace(/[^0-9]/g, '')}?text=${encodeURIComponent(message)}`;
            
            // Open WhatsApp
            window.open(whatsappUrl, '_blank');
            
            // Add to history
            messageHistory.unshift({
                id: Date.now(),
                recipient: document.getElementById('recipientSelect').selectedOptions[0].text,
                phone: recipient,
                message: message,
                sent: new Date().toISOString(),
                status: 'sent'
            });
            
            // Clear form
            document.getElementById('recipientSelect').value = '';
            document.getElementById('messageContent').value = '';
            
            // Re-render
            renderCommunication();
        }

        function useTemplate(templateId) {
            const template = messageTemplates.find(t => t.id === templateId);
            if (template) {
                document.getElementById('messageContent').value = template.content;
            }
        }

        // PWA functions
        let deferredPrompt;
        
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            document.getElementById('installApp').classList.remove('hidden');
        });

        document.getElementById('installApp').addEventListener('click', async () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                if (outcome === 'accepted') {
                    document.getElementById('installApp').classList.add('hidden');
                }
                deferredPrompt = null;
            }
        });

        // Create PWA manifest dynamically
        const manifest = {
            name: "מערכת ניהול אירועי בר מצווה",
            short_name: "בר מצווה מנהל",
            description: "מערכת ניהול מקצועית לאירועי בר מצווה",
            start_url: "/",
            display: "standalone",
            background_color: "#ffffff",
            theme_color: "#1e3a8a",
            icons: [
                {
                    src: "data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 192 192'><rect width='192' height='192' fill='%231e3a8a'/><text y='96' x='96' text-anchor='middle' dominant-baseline='middle' font-size='80' fill='white'>🎵</text></svg>",
                    sizes: "192x192",
                    type: "image/svg+xml"
                },
                {
                    src: "data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'><rect width='512' height='512' fill='%231e3a8a'/><text y='256' x='256' text-anchor='middle' dominant-baseline='middle' font-size='200' fill='white'>🎵</text></svg>",
                    sizes: "512x512",
                    type: "image/svg+xml"
                }
            ]
        };

        document.getElementById('manifest').href = 'data:application/json,' + encodeURIComponent(JSON.stringify(manifest));

        // Add new event function
        function addNewEvent() {
            if (!isLoggedIn) {
                alert('נדרשת התחברות כדי להוסיף אירוע');
                return;
            }
            
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
            modal.innerHTML = `
                <div class="bg-white rounded-3xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                    <div class="border-b border-gray-200 p-6 sticky top-0 bg-white rounded-t-3xl">
                        <div class="flex justify-between items-center">
                            <h3 class="text-xl font-bold text-gray-800">הוסף אירוע חדש</h3>
                            <button onclick="this.closest('.fixed').remove()" class="text-gray-400 hover:text-gray-600 text-2xl font-bold">×</button>
                        </div>
                    </div>
                    
                    <div class="p-6 space-y-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">שם בר המצווה</label>
                                <input type="text" id="newEventName" class="w-full border border-gray-300 rounded-xl px-3 py-2" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">תאריך</label>
                                <input type="date" id="newEventDate" class="w-full border border-gray-300 rounded-xl px-3 py-2" required>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">שעת הגעת אורחים</label>
                                <input type="time" id="newEventGuestTime" class="w-full border border-gray-300 rounded-xl px-3 py-2" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">שעת תחילת אירוע</label>
                                <input type="time" id="newEventStartTime" class="w-full border border-gray-300 rounded-xl px-3 py-2" required>
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">מיקום</label>
                            <input type="text" id="newEventLocation" class="w-full border border-gray-300 rounded-xl px-3 py-2" required>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">קישור Waze (אופציונלי)</label>
                            <input type="url" id="newEventWaze" class="w-full border border-gray-300 rounded-xl px-3 py-2" placeholder="https://waze.com/ul?q=...">
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">חבילה</label>
                                <select id="newEventPackage" class="w-full border border-gray-300 rounded-xl px-3 py-2" required>
                                    <option value="">בחר חבילה</option>
                                    <option value="חבילה בסיסית">חבילה בסיסית</option>
                                    <option value="חבילה חגיגית">חבילה חגיגית</option>
                                    <option value="חבילת הכל כלול">חבילת הכל כלול</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">מחיר</label>
                                <input type="number" id="newEventPrice" class="w-full border border-gray-300 rounded-xl px-3 py-2" min="0" required>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">שם ההורה</label>
                                <input type="text" id="newEventParentName" class="w-full border border-gray-300 rounded-xl px-3 py-2" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">טלפון</label>
                                <input type="tel" id="newEventPhone" class="w-full border border-gray-300 rounded-xl px-3 py-2" required>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="flex items-center">
                                <input type="checkbox" id="newEventKeyboardist" class="w-4 h-4 text-blue-600 rounded ml-2">
                                <label for="newEventKeyboardist" class="text-sm font-medium text-gray-700">קלידן</label>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">מספר מתופפים</label>
                                <input type="number" id="newEventDrummers" class="w-full border border-gray-300 rounded-xl px-3 py-2" min="0" max="5" value="0">
                            </div>
                            <div class="flex items-center">
                                <input type="checkbox" id="newEventIsStudent" class="w-4 h-4 text-blue-600 rounded ml-2">
                                <label for="newEventIsStudent" class="text-sm font-medium text-gray-700">תלמיד פרטי</label>
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">הערות</label>
                            <textarea id="newEventNotes" class="w-full border border-gray-300 rounded-xl px-3 py-2 h-20 resize-none"></textarea>
                        </div>
                        
                        <div class="flex justify-end space-x-3 space-x-reverse pt-6 border-t border-gray-200">
                            <button onclick="this.closest('.fixed').remove()" class="px-6 py-2 bg-gray-200 text-gray-700 rounded-xl hover:bg-gray-300 transition-colors">
                                ביטול
                            </button>
                            <button onclick="saveNewEvent()" class="px-6 py-2 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors">
                                שמור אירוע
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        function saveNewEvent() {
            // Get form values
            const name = document.getElementById('newEventName').value;
            const date = document.getElementById('newEventDate').value;
            const guestTime = document.getElementById('newEventGuestTime').value;
            const startTime = document.getElementById('newEventStartTime').value;
            const location = document.getElementById('newEventLocation').value;
            const wazeLink = document.getElementById('newEventWaze').value;
            const package = document.getElementById('newEventPackage').value;
            const price = parseInt(document.getElementById('newEventPrice').value);
            const parentName = document.getElementById('newEventParentName').value;
            const phone = document.getElementById('newEventPhone').value;
            const keyboardist = document.getElementById('newEventKeyboardist').checked;
            const drummers = parseInt(document.getElementById('newEventDrummers').value);
            const isStudent = document.getElementById('newEventIsStudent').checked;
            const notes = document.getElementById('newEventNotes').value;

            // Validate required fields
            if (!name || !date || !guestTime || !startTime || !location || !package || !price || !parentName || !phone) {
                alert('אנא מלא את כל השדות הנדרשים');
                return;
            }

            // Create new event object
            const newEvent = {
                id: Date.now(), // Simple ID generation
                name: name,
                date: date,
                time: startTime, // For backward compatibility
                guestArrivalTime: guestTime,
                eventStartTime: startTime,
                location: location,
                wazeLink: wazeLink || `https://waze.com/ul?q=${encodeURIComponent(location)}`,
                package: package,
                keyboardist: keyboardist,
                drummers: drummers,
                isStudent: isStudent,
                price: price,
                parentPhone: phone,
                parentName: parentName,
                notes: notes,
                status: 'pending'
            };

            // Add to events array
            events.push(newEvent);
            filteredEvents = [...events];

            // Close modal
            document.querySelector('.fixed').remove();

            // Re-render events
            renderEvents();

            alert('אירוע נוסף בהצלחה!');
        }

        // Utility functions for new features
        function addLesson() {
            alert('הוספת שיעור חדש - פונקציה זו תפותח בהמשך');
        }

        function blockDate() {
            alert('חסימת תאריך - פונקציה זו תפותח בהמשך');
        }

        function editLesson(id) {
            alert(`עריכת שיעור ${id} - פונקציה זו תפותח בהמשך`);
        }

        function sendReminder(id) {
            const lesson = lessons.find(l => l.id === id);
            if (lesson) {
                const message = `שלום ${lesson.studentName}, תזכורת לשיעור מחר ב-${lesson.time}. נתראה!`;
                const phone = students.find(s => s.name === lesson.studentName)?.phone || '';
                if (phone) {
                    const whatsappUrl = `https://wa.me/${phone.replace(/[^0-9]/g, '')}?text=${encodeURIComponent(message)}`;
                    window.open(whatsappUrl, '_blank');
                }
            }
        }

        function addNewSong() {
            alert('הוספת שיר חדש - פונקציה זו תפותח בהמשך');
        }

        function filterByCategory() {
            renderSongsLibrary();
        }

        function addToPlaylist(songId) {
            alert(`הוספת שיר ${songId} לרשימה - פונקציה זו תפותח בהמשך`);
        }

        function createPlaylist() {
            alert('יצירת רשימת שירים חדשה - פונקציה זו תפותח בהמשך');
        }

        function viewPlaylist(playlistId) {
            alert(`צפייה ברשימת שירים ${playlistId} - פונקציה זו תפותח בהמשך`);
        }

        // Student management functions
        function toggleRecording(studentId) {
            const student = students.find(s => s.id === studentId);
            if (student) {
                student.hasRecording = !student.hasRecording;
                if (student.hasRecording) {
                    const notes = prompt('הכנס הערות על ההקלטה:', student.recordingNotes || '');
                    if (notes !== null) {
                        student.recordingNotes = notes;
                    }
                } else {
                    student.recordingNotes = 'עדיין לא מוכן להקלטה';
                }
                renderStudents();
            }
        }

        function editStudent(studentId) {
            const student = students.find(s => s.id === studentId);
            if (!student) return;

            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
            modal.innerHTML = `
                <div class="bg-white rounded-3xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                    <div class="border-b border-gray-200 p-6 sticky top-0 bg-white rounded-t-3xl">
                        <div class="flex justify-between items-center">
                            <h3 class="text-xl font-bold text-gray-800">עריכת פרטי תלמיד - ${student.name}</h3>
                            <button onclick="this.closest('.fixed').remove()" class="text-gray-400 hover:text-gray-600 text-2xl font-bold">×</button>
                        </div>
                    </div>
                    
                    <div class="p-6 space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">פרשה</label>
                                <input type="text" id="editParsha" value="${student.parsha}" class="w-full border border-gray-300 rounded-xl px-3 py-2">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">סוג קריאה</label>
                                <select id="editReadingType" class="w-full border border-gray-300 rounded-xl px-3 py-2">
                                    <option value="עליית ראשון בלבד" ${student.readingType === 'עליית ראשון בלבד' ? 'selected' : ''}>עליית ראשון בלבד</option>
                                    <option value="עליית ראשון + מפטיר" ${student.readingType === 'עליית ראשון + מפטיר' ? 'selected' : ''}>עליית ראשון + מפטיר</option>
                                    <option value="מפטיר בלבד" ${student.readingType === 'מפטיר בלבד' ? 'selected' : ''}>מפטיר בלבד</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">קטע בתורה</label>
                                <input type="text" id="editTorahPortion" value="${student.torahPortion}" class="w-full border border-gray-300 rounded-xl px-3 py-2">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">הפטרה</label>
                                <input type="text" id="editHaftarah" value="${student.haftarah}" class="w-full border border-gray-300 rounded-xl px-3 py-2">
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">התקדמות כללית</label>
                            <textarea id="editProgress" class="w-full border border-gray-300 rounded-xl px-3 py-2 h-20 resize-none">${student.progress}</textarea>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">הערות מיוחדות</label>
                            <textarea id="editSpecialNotes" class="w-full border border-gray-300 rounded-xl px-3 py-2 h-20 resize-none">${student.specialNotes}</textarea>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">הערות הקלטה</label>
                            <textarea id="editRecordingNotes" class="w-full border border-gray-300 rounded-xl px-3 py-2 h-16 resize-none">${student.recordingNotes}</textarea>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">שיעורים שהושלמו</label>
                                <input type="number" id="editLessonsCompleted" value="${student.lessonsCompleted}" min="0" max="${student.totalLessons}" class="w-full border border-gray-300 rounded-xl px-3 py-2">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">סה"כ שיעורים</label>
                                <input type="number" id="editTotalLessons" value="${student.totalLessons}" min="1" class="w-full border border-gray-300 rounded-xl px-3 py-2">
                            </div>
                        </div>
                        
                        <div class="flex justify-end space-x-3 space-x-reverse pt-6 border-t border-gray-200">
                            <button onclick="this.closest('.fixed').remove()" class="px-6 py-2 bg-gray-200 text-gray-700 rounded-xl hover:bg-gray-300 transition-colors">
                                ביטול
                            </button>
                            <button onclick="saveStudentChanges(${studentId})" class="px-6 py-2 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors">
                                שמור שינויים
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        function saveStudentChanges(studentId) {
            const student = students.find(s => s.id === studentId);
            if (!student) return;

            // Update student data
            student.parsha = document.getElementById('editParsha').value;
            student.readingType = document.getElementById('editReadingType').value;
            student.torahPortion = document.getElementById('editTorahPortion').value;
            student.haftarah = document.getElementById('editHaftarah').value;
            student.progress = document.getElementById('editProgress').value;
            student.specialNotes = document.getElementById('editSpecialNotes').value;
            student.recordingNotes = document.getElementById('editRecordingNotes').value;
            student.lessonsCompleted = parseInt(document.getElementById('editLessonsCompleted').value);
            student.totalLessons = parseInt(document.getElementById('editTotalLessons').value);

            // Close modal
            document.querySelector('.fixed').remove();
            
            // Re-render students
            renderStudents();
            
            alert('פרטי התלמיד עודכנו בהצלחה!');
        }

        function viewStudentProgress(studentId) {
            const student = students.find(s => s.id === studentId);
            if (!student) return;

            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
            modal.innerHTML = `
                <div class="bg-white rounded-3xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                    <div class="border-b border-gray-200 p-6 sticky top-0 bg-white rounded-t-3xl">
                        <div class="flex justify-between items-center">
                            <h3 class="text-xl font-bold text-gray-800">יומן שיעורים - ${student.name}</h3>
                            <button onclick="this.closest('.fixed').remove()" class="text-gray-400 hover:text-gray-600 text-2xl font-bold">×</button>
                        </div>
                    </div>
                    
                    <div class="p-6">
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                            <div class="bg-blue-50 p-4 rounded-2xl border border-blue-200">
                                <h4 class="font-semibold text-blue-800 mb-2">התקדמות כללית</h4>
                                <div class="text-2xl font-bold text-blue-600">${Math.round((student.lessonsCompleted / student.totalLessons) * 100)}%</div>
                                <div class="text-sm text-blue-600">${student.lessonsCompleted}/${student.totalLessons} שיעורים</div>
                            </div>
                            
                            <div class="bg-green-50 p-4 rounded-2xl border border-green-200">
                                <h4 class="font-semibold text-green-800 mb-2">זמן עד האירוע</h4>
                                <div class="text-lg font-bold text-green-600">${Math.ceil((new Date(student.eventDate) - new Date()) / (1000 * 60 * 60 * 24))} ימים</div>
                                <div class="text-sm text-green-600">${new Date(student.eventDate).toLocaleDateString('he-IL')}</div>
                            </div>
                            
                            <div class="bg-purple-50 p-4 rounded-2xl border border-purple-200">
                                <h4 class="font-semibold text-purple-800 mb-2">שיעור הבא</h4>
                                <div class="text-lg font-bold text-purple-600">${new Date(student.nextLesson).toLocaleDateString('he-IL')}</div>
                                <div class="text-sm text-purple-600">בעוד ${Math.ceil((new Date(student.nextLesson) - new Date()) / (1000 * 60 * 60 * 24))} ימים</div>
                            </div>
                        </div>
                        
                        <div class="bg-gray-50 p-6 rounded-2xl">
                            <h4 class="font-semibold text-gray-800 mb-4">פירוט שיעורים אחרונים</h4>
                            <div class="text-center text-gray-500 py-8">
                                <div class="text-4xl mb-2">📚</div>
                                <div>פונקציה זו תפותח בהמשך</div>
                                <div class="text-sm">כאן יוצגו פרטי השיעורים, נושאים שנלמדו, ומשימות</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        // Enhanced Decap CMS configuration
        function openDecapCMS() {
            const cmsConfig = {
                backend: {
                    name: 'git-gateway',
                    branch: 'main'
                },
                media_folder: 'static/images',
                public_folder: '/images',
                collections: [
                    {
                        name: 'events',
                        label: 'אירועים',
                        folder: 'content/events',
                        create: true,
                        slug: '{{year}}-{{month}}-{{day}}-{{slug}}',
                        fields: [
                            { label: 'שם בר המצווה', name: 'name', widget: 'string' },
                            { label: 'תאריך', name: 'date', widget: 'datetime' },
                            { label: 'שעת הגעת אורחים', name: 'guestArrivalTime', widget: 'string' },
                            { label: 'שעת תחילת אירוע', name: 'eventStartTime', widget: 'string' },
                            { label: 'מיקום', name: 'location', widget: 'string' },
                            { label: 'קישור Waze', name: 'wazeLink', widget: 'string', required: false },
                            { label: 'חבילה', name: 'package', widget: 'select', options: ['חבילה בסיסית', 'חבילה חגיגית', 'חבילת הכל כלול'] },
                            { label: 'קלידן', name: 'keyboardist', widget: 'boolean', default: false },
                            { label: 'מספר מתופפים', name: 'drummers', widget: 'number', default: 0 },
                            { label: 'תלמיד פרטי', name: 'isStudent', widget: 'boolean', default: false },
                            { label: 'מחיר', name: 'price', widget: 'number' },
                            { label: 'שם ההורה', name: 'parentName', widget: 'string' },
                            { label: 'טלפון', name: 'parentPhone', widget: 'string' },
                            { label: 'הערות', name: 'notes', widget: 'text', required: false },
                            { label: 'סטטוס', name: 'status', widget: 'select', options: ['confirmed', 'pending'], default: 'pending' }
                        ]
                    },
                    {
                        name: 'students',
                        label: 'תלמידים',
                        folder: 'content/students',
                        create: true,
                        slug: '{{slug}}',
                        fields: [
                            { label: 'שם התלמיד', name: 'name', widget: 'string' },
                            { label: 'תאריך בר מצווה', name: 'eventDate', widget: 'datetime' },
                            { label: 'שיעורים שהושלמו', name: 'lessonsCompleted', widget: 'number', default: 0 },
                            { label: 'סה"כ שיעורים', name: 'totalLessons', widget: 'number', default: 12 },
                            { label: 'שיעור הבא', name: 'nextLesson', widget: 'datetime' },
                            { label: 'טלפון', name: 'phone', widget: 'string' },
                            { label: 'התקדמות כללית', name: 'progress', widget: 'text' },
                            { label: 'פרשה', name: 'parsha', widget: 'string' },
                            { label: 'סוג קריאה', name: 'readingType', widget: 'select', options: ['עליית ראשון בלבד', 'עליית ראשון + מפטיר', 'מפטיר בלבד'] },
                            { label: 'יש הקלטה', name: 'hasRecording', widget: 'boolean', default: false },
                            { label: 'הערות הקלטה', name: 'recordingNotes', widget: 'text', required: false },
                            { label: 'הפטרה', name: 'haftarah', widget: 'string' },
                            { label: 'קטע בתורה', name: 'torahPortion', widget: 'string' },
                            { label: 'הערות מיוחדות', name: 'specialNotes', widget: 'text', required: false }
                        ]
                    },
                    {
                        name: 'prayer-songs',
                        label: 'שירי תפילה',
                        folder: 'content/prayer-songs',
                        create: true,
                        slug: '{{slug}}',
                        fields: [
                            { label: 'שם השיר', name: 'name', widget: 'string' },
                            { label: 'סולם', name: 'key', widget: 'string' },
                            { label: 'קצב (BPM)', name: 'tempo', widget: 'number' },
                            { label: 'טרנספוזיציה', name: 'transpose', widget: 'number', default: 0 },
                            { label: 'אקורדים', name: 'chords', widget: 'string' },
                            { label: 'מילים', name: 'lyrics', widget: 'text' }
                        ]
                    },
                    {
                        name: 'meal-songs',
                        label: 'שירי סעודה',
                        folder: 'content/meal-songs',
                        create: true,
                        slug: '{{slug}}',
                        fields: [
                            { label: 'שם השיר', name: 'name', widget: 'string' },
                            { label: 'סולם', name: 'key', widget: 'string' },
                            { label: 'קצב (BPM)', name: 'tempo', widget: 'number' },
                            { label: 'טרנספוזיציה', name: 'transpose', widget: 'number', default: 0 },
                            { label: 'אקורדים', name: 'chords', widget: 'string' },
                            { label: 'מילים', name: 'lyrics', widget: 'text' }
                        ]
                    },
                    {
                        name: 'system-data',
                        label: 'נתוני המערכת (מתקדם)',
                        files: [
                            {
                                label: 'כל נתוני המערכת',
                                name: 'all-data',
                                file: 'content/system-data.json',
                                fields: [
                                    {
                                        label: 'נתוני המערכת המלאים (JSON)',
                                        name: 'data',
                                        widget: 'code',
                                        default_language: 'json',
                                        default: JSON.stringify(systemData, null, 2)
                                    }
                                ]
                            }
                        ]
                    }
                ]
            };

            if (window.CMS) {
                window.CMS.init({ config: cmsConfig });
                window.open('/admin/', '_blank');
            } else {
                alert('Decap CMS לא זמין. אנא בדוק את ההגדרות.');
            }
        }

        // Search functionality for songs
        document.addEventListener('DOMContentLoaded', () => {
            const songSearch = document.getElementById('songSearch');
            if (songSearch) {
                songSearch.addEventListener('input', () => {
                    if (currentPage === 'songs-library') {
                        renderSongsLibrary();
                    }
                });
            }
        });

        // CMS Data Loading Functions
        async function loadDataFromCMS() {
            try {
                console.log('מנסה לטעון נתונים מ-CMS...');
                
                // Try to load from single JSON file first
                const systemDataResponse = await fetch('/content/system-data.json');
                if (systemDataResponse.ok) {
                    const cmsData = await systemDataResponse.json();
                    
                    // Update events
                    if (cmsData.events && Array.isArray(cmsData.events)) {
                        events.length = 0;
                        events.push(...cmsData.events);
                        filteredEvents = [...events];
                        console.log(`נטענו ${events.length} אירועים מ-CMS`);
                    }
                    
                    // Update students
                    if (cmsData.students && Array.isArray(cmsData.students)) {
                        students.length = 0;
                        students.push(...cmsData.students);
                        console.log(`נטענו ${students.length} תלמידים מ-CMS`);
                    }
                    
                    // Update prayer songs
                    if (cmsData.prayerSongs && Array.isArray(cmsData.prayerSongs)) {
                        prayerSongs.length = 0;
                        prayerSongs.push(...cmsData.prayerSongs);
                        console.log(`נטענו ${prayerSongs.length} שירי תפילה מ-CMS`);
                    }
                    
                    // Update meal songs
                    if (cmsData.mealSongs && Array.isArray(cmsData.mealSongs)) {
                        mealSongs.length = 0;
                        mealSongs.push(...cmsData.mealSongs);
                        console.log(`נטענו ${mealSongs.length} שירי סעודה מ-CMS`);
                    }
                    
                    // Update other data if exists
                    if (cmsData.equipment) {
                        equipment.length = 0;
                        equipment.push(...cmsData.equipment);
                    }
                    
                    if (cmsData.payments) {
                        payments.length = 0;
                        payments.push(...cmsData.payments);
                    }
                    
                    console.log('✅ נתונים נטענו בהצלחה מ-CMS');
                    showNotification('נתונים עודכנו מהמערכת', 'success');
                    return true;
                }
                
                // If single file doesn't exist, try individual files
                await loadIndividualFiles();
                return true;
                
            } catch (error) {
                console.log('❌ שגיאה בטעינת נתונים מ-CMS:', error);
                console.log('🔄 משתמש בנתונים ברירת מחדל');
                showNotification('משתמש בנתונים מקומיים', 'info');
                return false;
            }
        }

        async function loadIndividualFiles() {
            console.log('מנסה לטעון קבצים נפרדים...');
            
            // This would be implemented if using separate files
            // For now, we'll use the default data
            throw new Error('Individual files not implemented yet');
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 z-50 px-4 py-2 rounded-2xl text-white font-medium transition-all duration-300 ${
                type === 'success' ? 'bg-green-600' : 
                type === 'error' ? 'bg-red-600' : 
                'bg-blue-600'
            }`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // Export current data to CMS format
        function exportToCMSFormat() {
            const cmsData = {
                events: events,
                students: students,
                prayerSongs: prayerSongs,
                mealSongs: mealSongs,
                equipment: equipment,
                payments: payments,
                lessons: lessons,
                blockedDates: blockedDates,
                messageTemplates: messageTemplates,
                messageHistory: messageHistory,
                songsLibrary: songsLibrary,
                playlists: playlists,
                lastUpdated: new Date().toISOString()
            };
            
            // Create downloadable JSON file
            const dataStr = JSON.stringify(cmsData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = 'system-data.json';
            link.click();
            
            URL.revokeObjectURL(url);
            showNotification('קובץ נתונים הורד בהצלחה!', 'success');
        }

        // Manual data refresh
        async function refreshDataFromCMS() {
            showNotification('מרענן נתונים...', 'info');
            const success = await loadDataFromCMS();
            if (success) {
                renderCurrentPage();
                showNotification('נתונים עודכנו בהצלחה!', 'success');
            } else {
                showNotification('שגיאה בעדכון נתונים', 'error');
            }
        }

        // Handle Auth0 callback
        async function handleAuth0Callback() {
            if (window.location.search.includes('code=') || window.location.search.includes('error=')) {
                try {
                    await auth0Client.handleRedirectCallback();
                    login();
                    currentAuthProvider = 'auth0';
                    
                    // Clean up URL
                    window.history.replaceState({}, document.title, window.location.pathname);
                    
                    console.log('Auth0 login successful');
                } catch (error) {
                    console.error('Auth0 callback error:', error);
                    alert('שגיאה בהתחברות: ' + error.message);
                }
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', async () => {
            // First load data from CMS
            await loadDataFromCMS();
            
            // Then initialize auth
            await initAuth0();
            
            // Handle Auth0 callback if present
            if (auth0Client) {
                await handleAuth0Callback();
                
                // Check for existing Auth0 authentication
                try {
                    const isAuthenticated = await auth0Client.isAuthenticated();
                    if (isAuthenticated && !isLoggedIn) {
                        login();
                        currentAuthProvider = 'auth0';
                        console.log('User already authenticated with Auth0');
                    }
                } catch (error) {
                    console.log('Auth0 check failed:', error);
                }
            }
            
            // Render the page
            renderEvents();
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9632064c00631890',t:'MTc1MzE3NzczMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><iframe height="1" width="1" style="position: absolute; top: 0px; left: 0px; border: none; visibility: hidden;"></iframe>

<iframe id="netlify-identity-widget" title="Netlify identity widget" style="position: fixed; top: 0; left: 0; border: none; width: 100%; height: 100%; overflow: visible; background: transparent; display: none; z-index: 99; " src="about:blank"></iframe></body></html>